% !TEX TS-program = xelatex
% !TEX encoding = UTF-8 Unicode

% \documentclass[AutoFakeBold]{LZUThesis}
\documentclass[AutoFakeBold]{LZUThesis-PgD&PhD}


\begin{document}
	%=====%
	%
	%封皮页填写内容
	%
	%=====%
	
	\schoolcode{10730}
	\secret{公开}
	\cid{025200}
	% \yjsType{博士}
	\yjsType{硕士}
	
	% \yjsZsZy{\quad 学\quad 术\quad 学\quad 位\quad}
	\yjsZsZy{\quad 专\quad 业\quad 学\quad 位\quad}
	
	
	% 标题样式 使用 \title{{}}; 使用时必须保证至少两个外侧括号
	%  如： 短标题 \title{{第一行}},
	% 	      长标题 \title{{第一行}{第二行}}
	%             超长标题\tiitle{{第一行}{...}{第N行}}
	\title{{基于机器学习的植物病害预测模型构建}}
	
	% 标题样式 使用 \entitle{{}}; 使用时必须保证至少两个外侧括号
	%  如： 短标题 \entitle{{First row}},
	% 	      长标题 \entitle{{First row}{ Second row}}
	%             超长标题\entitle{{First row}{...}{ Next N row}}
	% 注意：  英文标题多行时 需要在开头加个空格 防止摘要标题处英语单词粘连。
	\entitle{
		{ Construction of Machine Learning-Based Models}
		{ for Plant Disease Analysis and Prediction}}
	
	\author{饶永祺}
	
	% \major{一级学科·专业}
	\major{应用统计}
	
	\research{生态统计学}
	
	% \education{学历教育/同等学力人员申请博士学位}
	\education{学历教育}
	% \education{学历教育/同等学力人员申请硕士学位/在职攻读硕士专业学位（非学历）}
	
	\advisor{刘向 研究员}
	\codvisor{} %合作导师，可为空，但不可没有这一栏
	\elapse{2022 年 9月\quad 至 \quad 2025 年 6 月}
	\defense{2025 年 6 月}
	
	\maketitle
	
	
	% \education{学历教育/同等学力人员申请博士学位}
	%======%
	%诚信说明页
	%授权说明书
	%======%
	% 如果超出边界，可以调整签字的宽度，现在是50，如果你不用，把下面的注释就好
	
	% 你的签名
	\mysignature{
		% \raisebox{-5pt}{
			% \includegraphics[width=40pt]{signature.pdf}
			% }
	}
	% 你手写的日期
	\mytime{
		% \raisebox{-5pt}{
			% \includegraphics[width=40pt]{signature.pdf}
			% }
	}
	% 老师的手写签名
	\supervisorsignature{
		% \raisebox{-5pt}{
			% \includegraphics[width=40pt]{signature.pdf}
			% }
	}
	% 老师手写的时间
	\teachertime{
		% \raisebox{-5pSt}{
			% \includegraphics[width=40pt]{signature.pdf}
			% }
	}
	% 老师手写的成绩
	\recommendedgrade{
		% \raisebox{-5pt}{
			% \includegraphics[width=40pt]{signature.pdf}
			% }
	}
	
	\makestatement
	
	
	\frontmatter
	
	
	
	%中文摘要
	
	
	%中文摘要
		\ZhAbstract{俗话说，民以食为天。粮食的生产直接关系到人类的生存与发展，而植物病害是影响粮食安全的重要因素之一。植物在生长过程中会受到病原菌的侵染，进而导致大范围的农作物减产甚至绝收。植物病害的发生受到多种环境因素的影响，具有显著的空间和时间变化特征。然而，目前对于环境变量（如气候和土壤）如何驱动病害的发生仍存在较大的不确定性。此外，传统的植物病害预测方法主要依赖于人工观察和诊断，费时费力且易受人为误差的影响。植物病害的发生具有显著的空间和时间变化特征，但环境和土壤对植物病害的影响尚不确定。本研究整合多源大尺度环境数据（包括气候数据、土壤数据等），并利用机器学习方法构建了植物病害的预测模型，具体研究流程如下：
	\par 一、数据收集与预处理
	\par 本研究基于中国草地的实地调查数据，共收集了193个样点的植物病害数据，覆盖全国26个省级行政区。每个样点包含3-4个样方，共计记录了770条详细数据。结合全球气候数据库（WorldClim version 2.1）提取每个样点的气候数据，并从全球协调世界土壤数据库（HWSD）提取土壤数据。随后，我们在地图上可视化了样点的空间分布，并分析了各环境变量的取值范围及其相关性。
	\par 二、贝叶斯建模分析
	\par 采用贝叶斯统计模型，分析各个环境变量对植物病害严重程度的影响。结果表明，“土壤砂含量”对植物病害的发生具有显著的正向影响，而“经度”和“海拔”则呈现负相关关系。此外，“太阳辐射”、“风速”和“气压”的影响较为不确定，但可能在不同条件下具有不同的作用。
	\par 三、集成学习模型比较与预测
	\par 采用多种集成学习方法（如随机森林、梯度提升机等）进行植物病害的预测分析，并评估各变量的重要性。结果表明，“太阳辐射”是影响植物病害的最重要因素，地理因素（经度、纬度）和土壤因素（土壤砂含量）次之，而“气压”和“风速”的重要性值分别为0.08和0.07，表明它们对植物病害亦具有一定影响。此外，我们利用LazyRegressor优化模型选择，发现GradientBoostingRegressor（GBR）在所有模型中表现最佳。基于GBR的预测结果，我们绘制了中国地区植物病害的大尺度预测图，并进一步模拟了气候变化条件下的植物病害分布。
	\par 四、深度学习建模与优化
	\par 采用PyTorch和TensorFlow分别构建神经网络模型，并进行训练和优化。通过绘制训练集与测试集的R方变化曲线，评估模型的收敛情况和泛化能力。结果表明，PyTorch和TensorFlow的训练效果相似，但PyTorch的收敛速度稍慢。

	\par 本研究提出了一种基于多源大尺度环境数据的植物病害预测方法，并揭示了气候和土壤因子对植物病害的影响机制。研究结果不仅有助于理解植物病害的环境驱动因素，也可为全球气候变化背景下的病害防控提供科学依据。
	}{机器学习，大尺度研究}
	\EnAbstract{
		Food security is a fundamental concern for human survival and development, and plant diseases are one of the major factors threatening global agricultural production. During their growth, plants are susceptible to pathogen infections, which can result in widespread crop yield losses or even total failure. The occurrence of plant diseases is influenced by multiple environmental factors and exhibits significant spatial and temporal variability. However, the extent to which environmental variables (such as climate and soil conditions) drive disease outbreaks remains uncertain. Furthermore, traditional plant disease prediction methods rely heavily on manual observation and diagnosis, which are time-consuming, labor-intensive, and prone to human error. To address these challenges, this study integrates multi-source large-scale environmental data (including climate and soil data) and employs machine learning methods to develop a predictive model for plant diseases. The research framework is as follows:
		
		\par 1. Data Collection and Preprocessing
		\par This study is based on field survey data collected from grasslands in China, covering 193 sampling sites across 26 provincial-level administrative regions. Each site consists of 3–4 quadrats, resulting in a total of 770 detailed records. Climate data for each site were extracted from the WorldClim version 2.1 global climate database, while soil data were obtained from the Harmonized World Soil Database (HWSD). The spatial distribution of sampling sites was visualized on a map, and the ranges and correlations of environmental variables were analyzed.
		
		\par 2. Bayesian Modeling Analysis
		\par A Bayesian statistical model was employed to analyze the impact of various environmental variables on plant disease severity. The results indicate that "soil sand content" has a significant positive effect on plant diseases, whereas "longitude" and "altitude" show a negative correlation. The effects of other factors, such as "solar radiation," "wind speed," and "air pressure," remain uncertain but may vary under different conditions.
		
		\par 3. Comparison and Prediction Using Ensemble Learning Models
		\par Multiple ensemble learning methods (e.g., random forest and gradient boosting) were applied to predict plant disease occurrence, and the importance of different variables was assessed. The results reveal that "solar radiation" is the most influential factor in plant disease outbreaks, followed by geographic factors (longitude and latitude) and soil properties (soil sand content). The importance values of "air pressure" and "wind speed" are 0.08 and 0.07, respectively, indicating that they also play a role in disease occurrence. Additionally, the LazyRegressor package was used to optimize model selection, and GradientBoostingRegressor (GBR) demonstrated the best predictive performance among all models. Using GBR predictions, large-scale maps of plant disease distribution in China were generated, and further simulations were conducted to predict disease distribution under climate change scenarios.
		
		\par 4. Deep Learning Model Development and Optimization
		\par Deep learning models were constructed and trained using PyTorch and TensorFlow. The R Squared variation curves for the training and test datasets were plotted to evaluate model convergence and generalization ability. The results show that PyTorch and TensorFlow yield similar predictive performance, though PyTorch exhibits a slower convergence rate.
		
		\par This study proposes a plant disease prediction approach based on multi-source large-scale environmental data and reveals the impact of climate and soil factors on disease occurrence. The findings contribute to a better understanding of the environmental drivers of plant diseases and provide scientific insights for disease prevention and management in the context of global climate change.
		}{Machine Learning, Large-Scale Study}
	
	\tableofcontents
	%文章主体
	\mainmatter
	
	
	
	\chapter{前言}
	
	\section{植物病害概述}
	
	农业是对人类生活和经济状况影响较大的行业之一。农民缺乏对病害的认知，导致粮食产量下降\cite{nandhini2021plantleaf}。
	对植物病害识认的深化过程，如同人类对自然规律理解的不断推进，是一段漫长而充满智慧的旅程。
	早在古罗马时期，人们对作物生长和病害的了解更多依赖经验和传统。
	罗马农学家科尔梅拉 (Columella) 和普林尼 (Pliny the Elder) 在他们的著作中提到了一些作物病害现象，但常将其归因于天罚或神灵的干预，这种朴素的识认反映了当时人类对微观世界的无知\cite{columella1941agriculture}。
	中世纪的农业发展较为停滞，但到中国北魏时期的《齐民要术》中，可以看到对植物病害更系统的经验总结。
	作者贾思勰通过观察与实践，记录了病害发生的环境因素，如湿度、土壤和作物生长的关系，提出了简单的防治措施\cite{jia535qimin}。这种从经验中提炼规律的方式，是识认深化的一个重要阶段。
	到了文艺复兴后期，科学革命带来了观察和实验的兴起，列文虎克 (Antonie van Leeuwenhoek) 的显微镜发明揭开了微观世界的面纱。他首次通过显微镜观察到微生物的存在，为人类识认植物病害的病原基础。虽然他并未直接研究植物病害，但他的发现激发了后人从科学角度探索病害成因的兴趣\cite{leeuwenhoek1683observations}。
	随着植物病理学的养成，人们逐渐识认到真菌、细菌和病毒等微生物是许多植物病害的主要原因\cite{agrios2005plant}。
	这一认识过程贯穿了人类历史，从神秘主义的解释到经验总结，再到科学观察与验证，展现了人类对自然界认识的不断深化。
	这种进步不仅推动了农业生产技术的发展，也为现代植物病害的防治奠定了科学基础，为保障粮食安全和生态平衡作出了不可磨灭的贡献。

	植物病害对人类生产生活的影响既有有害的一面，也存在一定的有益作用。从有害的角度来看，植物病害对农业生产的威胁尤为显著。
	历史上，爱尔兰大饥荒便是植物病害造成严重后果的典型例子。19世纪40年代，爱尔兰的土豆作物因感染晚疫病而大面积减产，这种真菌病害不仅摧毁了大片的农田，
	还导致数百万人陷入饥饿困境，大量人口因此流离失所甚至丧生。
	此外，这场灾难还对爱尔兰的社会和经济产生了深远影响，加剧了社会动荡，推动了大规模的移民潮 \cite{ograda2009great}。
	这一案例揭示了植物病害在特定条件下如何从农业领域扩展到社会层面，带来深远的连锁反应。
	与此同时，为了应对这些威胁，人们不得不依赖大量化学药剂进行防控，而这种方式虽然在短期内有效，但长期使用可能对环境、土壤生态和人类健康造成不良影响。
	水稻稻瘟病、小麦赤霉病等重大病害在流行时常导致大范围减产，不仅加重农民的经济负担，还可能引发粮食价格波动，影响社会稳定。
	同时，病害还可能通过传播途径扩展到其他地区甚至跨国传播，带来生态风险。
	然而，植物病害在某些方面也具有一定的积极意义。植物病害在某些方面也具有一定的积极意义，这种积极作用在实际应用中体现得尤为明显。
	例如，茭白的独特生长便得益于其与植物病害之间的关系。茭白因感染了一种特定的真菌而形成了膨大的茎，这种病害实际上是茭白特有的品质来源，使其成为一种颇受欢迎的水生蔬菜。
	同时，植物病害在观赏植物的培育中也发挥了意想不到的作用。一些花卉通过病害的变异过程，产生了丰富多彩的斑纹和独特的色彩，使得这些植物在园艺中更加受欢迎，成为五彩斑斓的观赏品种。
	这些例子表明，植物病害在为农业生产带来挑战的同时，也为人类提供了新的研究方向和利用途径，不仅推动了相关领域的技术进步，还丰富了人们的生产生活。
	研究植物病害的机制有助于科学家深入了解植物与病原微生物的相互作用，这为育种提供了重要依据。例如，通过分析抗病基因，科学家可以培育出更具抗病能力的作物品种，提高农业生产效率。此外，某些植物病原菌还被广泛应用于生物技术领域，用于研究基因编辑或开发新型农药。同时，植物病害研究有助于促进病害监测技术的进步，为农业领域带来更加精准的管理方法，从长远看可以减少农药使用，推动可持续发展。
	总的来说，尽管植物病害带来了许多挑战，但其间蕴藏的研究价值和技术潜力也为农业现代化提供了重要机遇。
	这种双重影响提醒人们，科学应对植物病害不仅是减轻危害的需要，更是充分发掘其潜在价值的关键所在。
	
	
	
	\subsection{植物病害分类}
	
	植物在生长过程中受到多种病原体的侵害，其中病原真菌和卵菌是主要的病原体，严重影响植物的生长和发育。
	相关研究表明，锈菌、白粉菌以及卵菌中的疫霉菌和霜霉菌是导致植物病害的主要原因，造成植物形态异常、
	功能受损和生理受限，进而引发一系列植物病害 \cite{mendgen2002plant, glawe2008powdery, kamoun2015top, thines2016diversity}。这些病害不仅影响植物的生长，还对农业生产造成显著威胁，导致农作物减产和品质下降 \cite{gisi2002mechanisms, erwin1996phytophthora}。
	
	锈病（Rust disease）通常表现为植物叶片和茎秆上出现小斑点，随着病情加重，可能导致叶片脱落和植株枯死。
	该病害的发生与环境湿度、温度及病原菌的传播密切相关，在高湿环境下，锈病病原体更易繁殖，导致病害的迅速扩散\cite{mendgen2002plant, huber1992modeling}。
	白粉病（Powdery mildew）主要表现为植物表面覆盖一层白色粉状物，严重影响植物的光合作用，进而影响其生长。白粉病的病原菌在温暖、干燥的环境中更容易传播，导致大规模的植物感染 \cite{glawe2008powdery, yarwood1957powdery}。叶斑病（Leaf spot disease）的特征是叶片上出现各种颜色的斑点，随着病情的加重，斑点逐渐扩散，最终导致叶片枯萎 \cite{agrios2005plant, thomma2003alternaria}。
	
	植物病害的分类可以从多个方面进行划分，主要包括病原、受害部位、症状表现、传播途径、病害的生活史类型以及侵染性和非侵染性病害等。按照病原分类，植物病害可以分为真菌、细菌、病毒、线虫等生物性病害，以及由干旱、盐害、缺素等非生物因子引起的病害。例如，稻瘟病属于真菌病害，而烟草花叶病毒病则是典型的病毒病害\cite{goldbach2001tobacco, desselberger2015viruses}。根据受害部位，病害可能影响植物的根部、茎部、叶部或果实，甚至是整个植株，像根结线虫病通常集中在根部，而白粉病则主要发生在叶片上\cite{glawe2008powdery}。若从症状表现分类，植物病害可能表现为枯萎、腐烂、斑点、变色或畸形等现象。
	例如，枯萎病会导致植物整株萎蔫，叶斑病则会在叶片上形成斑点，而黄化病则使植物整体变黄失绿\cite{watson2009comparing}。

	从传播途径来看，某些病害通过土壤传播，如根腐病；有些通过空气或昆虫媒介传播，例如小麦锈病和花叶病毒病；还有一些病害通过种子传播，像稻瘟病的病原可以依附在种子表面或潜藏在种子内部，成为下一个生长季病害的来源\cite{zeigler1996rice, kamoun2005late}。

	
	植物病害菌的生活史类型也影响其传播方式。
	生活史较简单的病害如稻瘟病，其病原体通过孢子、种子或土壤传播，病原菌能够在季节更替时通过病残体存活，一旦条件适宜，便迅速繁殖并感染寄主 \cite{zeigler1996rice,qiu2010}。
	生活史较复杂的病害如梨锈病，其病原菌需要在两种寄主之间交替完成生命周期，春季时从桧柏上产生的锈孢子传播至梨树，在梨树叶片或果实上引发病害并形成孢子器，然后这些孢子通过风传播回桧柏，从而完成病原的循环传播 \cite{yu2018,jacquemart2015life}。这种寄主交替的特点使得锈病防控变得尤为复杂，需要通过寄主隔离、修剪清理和药剂喷施等多种方式才能有效控制病害的传播 \cite{palmieri2022}。

	此外，侵染性病害和非侵染性病害的分类也非常重要。
	侵染性病害又叫传染性病害是由病原微生物引起的，具有传染性，能够通过空气、土壤、昆虫或种子传播。
	而非侵染性病害则由环境因素或营养缺乏等非生物因子引起，通常没有传染性。
	这些分类标准结合应用，有助于揭示植物病害的发生规律，并为制定有效的防治措施提供科学依据，从而最大程度地减少病害对农业生产的威胁。
	
	\subsection{植物病害菌的生活史类型}
	
	病原物大体分为两类：一类病原物杀死寄主，然后从上面获得营养物质，即所谓的死体营养寄生物；另一类是需要获得寄主以完成它们的生活史，即活体营养寄生物。死体病害菌一般具有较强的腐蚀性，可以对多种寄主造成侵害，通常可以用木制培养基培养。而活体病害菌的专一性比较强，一般只能寄生于特定的寄主，形成特定的蛋白质机构从寄主细胞上获取营养物质，一般认为不能够脱离寄主存活。
	活体病原菌的一个短暂阶段代表了半活体营养病原菌。这类真菌在开始转向杀死寄主之前具有一个活体营养生长阶段。Fitzpatrick 和 Stajich (2015) 讨论了真菌病原体的比较基因组学，强调宿主与病原体之间的相互作用以及致病机制的演变，为理解病原体如何适应宿主提供了重要视角\cite{fitzpatrick2015comparative}。
	Huang 和 Wang (2018) 通过比较基因组学分析病原性真菌的进化，探讨了不同病原体如何适应宿主环境以完成生活史\cite{huang2018evolution}。Pappas和Kauffman(2019)的综述聚焦于免疫系统受损宿主中的真菌感染，强调流行病学特征和管理策略\cite{pappas2019fungal}。Zhang和Zhang(2020)研究了真菌在腐生与寄生生活阶段之间的转换，讨论了这一过程对农业病害管理的启示\cite{zhang2020fungi}。Brunner 和 Kottke (2021) 则探讨了真菌病原体的复杂生活周期，分析了其从土壤获取营养到侵染宿主的机制，并强调了对植物病害管理的影响\cite{brunner2021complex}。
	
	
	\subsection{植物病害对于生态环境的影响}
	
	植物病害是影响生态系统功能和稳定性的重要因素，其对生态环境的影响具有多样性和复杂性。
	从个体植物到整个生态系统，病害不仅降低了植物的健康水平，还可能对物种多样性、栖息地结构和生态过程造成深远的影响 \cite{Mitchell2002}。
	病原微生物的传播和感染可能改变植物群落的组成和竞争格局，例如，一些致病真菌能够选择性地感染优势种，从而导致生态系统中的物种替代现象 \cite{Garrett2006}。
	这种影响在生物多样性热点地区尤为显著，因为那里的物种密度较高，传播路径更为复杂。
	植物病害对碳循环和养分循环也具有显著影响。
	病害引发的植被减少会降低碳固定能力，削弱生态系统对温室气体的吸收能力，同时病害引发的枯枝落叶分解加速可能增加土壤中碳的释放，进而加剧气候变化的影响 \cite{Allison2008}。
	此外，植物病害可能通过改变根际微生物群落和土壤养分平衡，进一步影响植物与土壤之间的反馈关系，形成一种复杂的负向循环 \cite{Bever2010}。
	在更大的生态系统范围内，植物病害会影响物种间的相互作用，包括授粉者和种子传播者的活动。
	例如，当某种植物由于病害而种群数量锐减时，依赖该植物的动物也会受到连锁反应的影响，进一步改变生态网络的动态平衡 \cite{Maron2011}。
	特别是在入侵物种或引入性病害的场景下，其影响可能更具毁灭性，例如栗疫病（\textit{Cryphonectria parasitica}）在北美地区导致了栗树几乎完全灭绝，这一事件显著改变了森林生态系统的结构和功能 \cite{Anagnostakis1987}。
	面对植物病害对生态环境的威胁，科学家提出了一系列应对策略，包括加强病害的早期监测与诊断、利用生物防治手段减少化学药剂的使用、以及采用抗病品种和恢复生态功能的综合治理措施 \cite{Pautasso2010}。
	与此同时，气候变化与全球化的背景下，国际合作在病害传播防控中的作用也变得尤为重要。
	总之，植物病害对生态环境的影响是多层次且深远的。通过持续监测、研究和采取综合应对措施，可以在一定程度上减缓病害对生态系统带来的破坏，维护生态环境的稳定性和可持续性。
	
	
	
	\subsection{植物抵御病害的防御策略}
	
	植物病害还可以通过改变植物与其他生物的互动，进而影响生态系统服务功能。
	植物的抗病性和恢复能力不仅决定了其对病害的抵抗程度，还影响到该植物在生态系统中的角色。
	例如，某些病害可能使植物的根系受到损害，导致水分和养分吸收能力下降，从而影响整个生态系统的水分循环和养分循环\cite{Schultz2010}。
	更严重的是，一些病害可以通过影响植物的光合作用过程，降低植物的碳固存能力，从而对全球碳循环产生负面影响\cite{Barton2011}。此外，病害的爆发可能促进某些害虫种群的繁殖，进一步加剧生态系统的不稳定性。
	总的来说，植物病害对生态环境的影响是多方面的，涉及植物健康、物种间的竞争与合作、生态系统的功能与服务等各个层面。未来的研究需要更加关注气候变化、全球化以及农业活动对植物病害传播的潜在影响，进一步加强对病害防治的科学管理，以维护生态系统的稳定与可持续性。


	植物抵御病害的方式多种多样，其中早熟是其中一种重要的适应机制。通过加速生长周期，早熟的植物能够在病害发生之前完成生长发育，减少病原菌的侵入机会 \cite{liu2020early}。
	例如，一些作物通过选择早熟品种或通过外部环境调节使得作物提前进入生长高峰期，从而在病害高发时节未受到过多的影响。
	另一重要的防御机制是气孔的开闭 \cite{harman2018stomatal}。气孔是植物进行气体交换的主要通道，然而，病原微生物通常通过气孔进入植物体内。
	为了避免病原的侵入，植物能够通过调节气孔的开闭来控制病害的扩散。在面对病原威胁时，植物会关闭气孔，从而减少病原通过气孔进入植物体内的机会 \cite{baker2018plant}。
	此外，植物在遇到病害时，常常通过气孔的反应与局部的免疫反应相结合，启动一系列抗病机制 \cite{zhu2019stomatal}。
	通过这些生理调节，植物能在不同的环境条件下及时做出反应，有效抵御病害 \cite{farago2020immune}。气孔的闭合与植物的免疫反应紧密相连，共同作用以提升植物的抗病能力 \cite{wang2021stomatal}。
	
	总之，植物的抗病性和感病性是在与病害的长期演化过程中形成的生理和遗传特性，植物通过调整生长周期、气孔的开闭等方式，强化自身的防御机制，减少病害的侵害。
	Jones等（2022）通过转录组测序揭示了某些植物病原真菌的致病机制，提供了新的靶点用于抗病性品种的育种\cite{jones2022}。Zhang等（2023）研究了新型植物病毒的基因组特征，阐明了其在植物中的传播机制，为植物病毒病害的监测和防控提供了理论基础\cite{zhang2023genomic}。
	植物的免疫机制是植物病害研究的另一个重要领域。研究发现，植物通过感知病原体的特征，激活自身的免疫反应，从而抵御病害的侵袭。
	Duan等（2022）通过基因编辑技术，揭示了植物中关键免疫受体的功能，推动了植物抗病性研究的进展\cite{duan2022gene}。
	此外，Li等（2023）研究了植物激素在免疫反应中的作用，指出一些植物激素不仅可以激活免疫反应，还可以调节植物的生长发育，促进植物的抗病能力\cite{li2023role}。
	在病害管理策略方面，科学家们正致力于开发新型的病害防治方法。
	Wang等（2024）提出了一种结合生物防治与化学防治的新策略，通过引入拮抗微生物与植物保护剂的联用，提高了病害防治的效果\cite{wang2024novel}。
	此外，智能农业技术的应用也为病害监测与管理提供了新机遇。
	Chen等（2024）研究了基于物联网的植物病害监测系统，通过实时数据分析与处理，能够快速识别病害并采取相应措施\cite{chen2024iot}。
	最后，新型抗病材料的开发也在植物病害防治中展现出广阔前景。研究者们探索了天然提取物、纳米材料及生物基材料在植物抗病性提升中的应用。
	Liu等（2023）研究表明，某些植物提取物具有显著的抗病作用，可以增强植物的免疫反应，从而提高植物对病害的抵抗能力\cite{liu2023natural}。
	
	
	\section{影响植物病害的环境因子}
	
	\subsection{影响植物病害的气候因子}
	
	最新研究表明，气候变化和全球变暖导致温度的升高和部分地区降水格局的改变，正在加剧这些病害的发生和传播。温暖潮湿的环境有利于病原体的繁殖和扩散，导致病害在更大范围内更频繁地发生。
	例如，科学家发现全球变暖导致的温度升高和降水模式的改变，正促使一些病原真菌和卵菌向新的地理区域扩展，这些区域以前并不适合它们的生存和繁殖。气候变化影响了植物的生理状态，使其更易受到病害侵染。实际上，温度和降水是影响叶片真菌病害的主要环境因子 \citep{Chakraborty2011, Bebber2013, Garrett2006, Velasquez2018, Delgado2020}。
	叶片真菌病害往往在高温、高湿的环境下较为严重。根据样点，使用机器学习方法预测全国病害有助于更好地认识到中国范围内病害的空间格局。
	植物病害对全球农业生产力和粮食安全构成重大挑战。及时准确地预测这些病害对于有效的病害管理和减轻策略至关重要。
	近年来，数据收集技术的进步促使了多样化数据集的获取，涵盖了气象条件、土壤特性、植物物种信息以及植物病害严重程度。
	草地对动物产业、土壤保护和生物多样性至关重要，但植物病害会降低产量和营养价值\cite{chakraborty2018climate}。
	病害选择性地影响了某些物种，从而减少了群落内的物种多样性和丰富度\cite{grunberg2023impact}。
	植物病理学家 Sarah J. Gurr 等人（2018）使用广义线性模型的研究发现，真菌和昆虫每年向两极迁移约7公里。
	相比之下，蠕虫（如线虫）则显示出向低纬度地区移动的趋势。
	对于其他分类群，如螨虫、细菌、双翅目、半翅目、膜翅目、等翅目、卵菌、原生动物、缨翅目和病毒，未观察到显著的纬度变化趋势。
	气候变化可能对不同害虫分类群的地理分布产生影响，其中一些群体正逐渐向两极迁移以适应新的环境条件。
	与此同时，二氧化碳浓度的升高导致植物病原体的感染能力增强\cite{sukumar2018co2}。
	Anne Ebeling 等人（2023）的研究分析了不同植物类型在不同年均温度和年均降水条件下受病害和无脊椎动物损害的情况，揭示了它们对环境变化的不同响应。
	研究发现，在年均降水增加和年均温度升高的条件下，杂草表现出显著的病害和无脊椎动物损害增加的趋势，尤其是在高温高湿的环境中更为明显。
	相反，草类和豆科植物对这些环境因素的响应相对稳定，没有显示出明显的损害程度增加的趋势\cite{ebeling2023response}。
	Deepa S. Pureswaran 等人（2024）探讨了气候变化对森林害虫的影响。
	他们综合了2013-2017年间的最新文献，深入讨论了气候变化如何影响昆虫的分布范围、数量、森林生态系统及昆虫群落的影响。
	研究发现，气候变化可以促进害虫爆发或破坏食物链，进而减少害虫爆发的严重程度。
	通过广义线性模型和大尺度空间分析，该研究揭示了气候变化对不同昆虫类群的地理分布和生态影响。此外，气候变化导致英国部分地区的极端天气增多\cite{angelotti2024forest}。
	
	\subsection{影响植物病害的土壤因子}
	
	土壤作为植物生长的基础，其化学元素的组成对植物的健康和抵抗病害的能力具有深远影响 \cite{marschner2012mineral}。  
	从化学元素的角度，植物需要的大量元素（如氮、磷、钾）和微量元素（如锌、铁、硼）共同作用，决定了植物生长的质量和抗病能力 \cite{bashir2020role}。  
	土壤中这些元素的供应平衡，不仅影响植物的正常生理代谢，还能增强其对病原微生物的抵抗力 \cite{rengel2003role}。  
	常量元素，如氮（N）、磷（P）和钾（K），是植物生长的基本需求。  
	氮是叶绿素合成和光合作用的关键，而磷参与能量转移和根系发育，钾则能增强植物的抗逆性，例如提高细胞壁的稳定性和病原菌侵染后的修复能力 \cite{liu2019effects}。  
	例如，在番茄的生长中，适量的钾供应可以提高果实的品质和植物的抗病能力，而氮磷的平衡能够促进番茄生长，同时减少根部病害的发生 \cite{zhao2014effect}。  
	在水稻中，钾能够显著增强对稻瘟病的抗性，而磷的充足供应有助于水稻的根系发育，增强其吸收能力和病害抵抗力 \cite{shahzad2020impact}。  
	微量元素虽然需求量小，却对植物的健康和病害防治至关重要 \cite{bashir2020role}。  
	例如，锌（Zn）在植物中参与多种酶的活性调控，能够增强对病原菌的抵抗力；硼（B）对于细胞壁的形成和结构稳定至关重要，缺硼容易导致植物细胞壁薄弱，病害易于侵入 \cite{rengel2003role}。  
	在番茄的生长中，硼的不足可能导致果实发育不良，增加病害的发生率 \cite{zhao2014effect}。  
	而在水稻中，锌的缺乏会导致植株矮小、叶片黄化，从而增加稻瘟病的风险 \cite{liu2019effects}。  
	不同植物对化学元素的需求存在差异，这使得土壤对植物病害的影响因作物类型而异。  
	番茄作为需钾较高的作物，土壤中钾的充足供应可以显著提高其抗病能力 \cite{zhao2014effect}；  
	而水稻更注重氮、磷和钾的协调平衡，同时对锌的需求也较为敏感 \cite{shahzad2020impact}。  
	因此，土壤中元素的种类、含量和比例直接影响植物的生长状态和病害抵抗能力 \cite{marschner2012mineral}。  
	土壤中的化学元素通过调控植物的生理状态，增强其病害抵抗能力。此外，合理的土壤管理，如补充有机质和调整pH值，还能优化元素的吸收效率 \cite{rengel2003role}。  
	例如，适当的有机肥能够提供微量元素，同时改善土壤结构，增强植物的根系活力。这些因素共同作用，使得健康的土壤不仅是植物生长的基石，也是植物抵抗病害的重要屏障 \cite{bashir2020role}。

	\section{影响植物病害的生物因子}
	
	\subsection{植物多样性}
	植物多样性对植物病害的发生具有显著影响。研究表明，植物多样性可以通过多种机制调节病害的传播和发生，其中最为重要的机制包括生态位分化、竞争作用和共生互作等。
	植物多样性较高的生态系统通常具备更强的抵抗病害的能力，因为在这些系统中，植物种类之间的竞争和生态位的分化会有效地限制病原的扩散。
	具体来说，植物多样性较高的环境可以减少病原在某一植物种群中的集中度，从而减轻病原的传播风险\cite{Mitchell2002}。
	此外，多样性还可能通过“群落抗性”效应，即某些植物通过化学或物理屏障抵抗病害，来抑制病原在群落中的传播。
	然而，植物多样性的影响并非总是积极的，某些情况下，高植物多样性反而可能导致病害的增加。
	例如，一些植物种类可能通过提供更为丰富的宿主资源，促进了病原的传播，特别是在植物种类间没有充分的竞争和抑制作用时。这种情况在引入外来病害或病原时尤其明显，其中外来物种可能通过与本地植物的相互作用，增强病害的发生频率\cite{Garrett2006}。
	在农业系统中，作物多样性被认为是一种有效的病害管理策略。
	多样化的农作物种植可以减少单一作物的大规模病害爆发，因为病原体难以在多个作物间传播，特别是当这些作物的病害敏感性各不相同时\cite{Pautasso2010}。
	例如，轮作和多种植系统通过引入不同的作物种类和轮换种植模式，打破了病原的生命周期，从而有效减轻了土传病害的发生。
	此外，植物多样性还与植物之间的相互作用密切相关，如共生微生物群落的变化可能影响植物对病原的抵抗能力。
	某些植物通过与土壤中的有益微生物，如根际真菌和细菌，建立共生关系，从而提高了植物的免疫反应和对病害的防御能力\cite{Bever2010}。
	这一机制表明，植物多样性不仅通过直接的物种多样性效应影响病害，还可能通过改变土壤微生物群落的结构，间接影响病害的发生。
	综上所述，植物多样性对植物病害的影响是复杂的，既有促进病害发生的情况，也有抑制病害的作用。
	不同的环境和生态系统中，植物多样性的影响可能有所不同，且其具体效果受到多种因素的调节。
	因此，未来的研究应更多关注植物多样性与植物病害之间的互动机制，尤其是不同生境下植物多样性对病害管理的潜力\cite{Allison2008,Maron2011}。
	
	\subsection{植物物种组成}
	
	
	植物物种组成对植物病害的发生具有显著影响。不同的物种组成通过影响植物之间的相互作用、病原的传播和植物的抗病能力，进而调节病害的发生频率和强度。
	在多样性较高的植物群落中，植物种间的竞争和生态位分化常常能够限制病原的扩散，因为病原难以在多个物种之间传播，尤其是当这些物种具备不同的抗病特性时\cite{Mitchell2002}。
	此外，多样化的植物物种组成有助于提升群落整体的抗病能力，例如某些植物通过化学屏障或物理屏障对病原进行抑制，从而减少病原的感染机会。
	然而，物种组成对病害的影响并非总是积极的。
	在一些情况下，植物群落中物种组成的变化可能反而促进病害的传播。
	例如，在一些由外来植物物种主导的群落中，这些外来物种可能为病原提供了更多的宿主资源，导致病害的传播加剧\cite{Garrett2006}。
	此外，当植物物种组成中的某些植物种类对病原具有较弱的抗性时，它们可能成为病原的“桥头堡”，使病原能够迅速传播至整个群落。
	在这种情况下，植物物种的均衡与合理配置变得尤为重要，尤其是在农业系统中，作物种类的选择和布局可以有效地减轻病害的发生。
	植物物种的组成还通过影响植物-病原之间的互作关系，间接影响病害的发生。
	例如，植物种类之间的相互作用可以改变植物对病原的免疫反应。
	一些植物可能通过与土壤中的有益微生物形成共生关系，增强其对病原的抵抗力，而某些植物则可能通过改变土壤环境或释放化学物质来干扰病原的扩散\cite{Bever2010}。
	在这些复杂的植物-病原-环境相互作用下，物种组成的变化会显著改变病害的发生模式。
	总之，植物物种组成对植物病害的发生具有双重影响，既能通过增加群落的抗病性来抑制病害，又可能通过改变群落结构或促进病原传播来加剧病害的扩展。
	因此，了解植物物种组成对病害的影响机制对于有效管理植物病害、提高生态系统稳定性具有重要意义\cite{Pautasso2010,Maron2011}。
	
	
	\subsection{物种均匀度}
	物种均匀度在植物病害的发生中发挥着重要作用，它直接影响植物群落的结构和功能，从而影响病原的传播和植物的抗病能力。
	物种均匀度是指群落中各物种的相对丰度是否均衡，即某一物种是否占据了较大的比例。
	高均匀度的植物群落通常意味着各物种之间的竞争较为平衡，这种平衡有助于防止某些物种因过度繁殖而成为病原的主要宿主，从而降低病害的风险。
	研究表明，在物种均匀度较高的生态系统中，植物种群的健康状况较好，病原的传播受到抑制，
	这可能是因为在高均匀度群落中，病原难以在单一物种上迅速扩散，从而减少了病害的发生频率\cite{Mitchell2002}。
	然而，物种均匀度对植物病害的影响并非总是积极的。
	在某些情况下，高均匀度的群落可能会促进病害的传播。特别是当物种间抗病性差异较小，或某些物种对病原的抗性较弱时，病原可能在均匀分布的植物种群中更容易传播。
	比如，在一些高均匀度的农业系统中，作物种类的相对丰度较为均衡，但由于这些作物的抗病性普遍较弱，病害传播的风险反而可能增大\cite{Garrett2006}。
	此外，物种均匀度的变化还可能通过影响植物-病原互作和植物之间的生态位分化来间接影响病害的发生。
	在均匀度较低的群落中，植物种类的生态位差异较大，这有助于限制病原的扩散，从而减缓病害的传播。
	此外，物种均匀度与群落中病原的多样性和丰度密切相关。在均匀度较高的群落中，病原可能有更多的宿主种类，因此可能表现出更高的适应性和传播能力。
	这种情况下，病原的多样性和丰度可能会随着宿主种类的增加而上升，从而促进病害的发生\cite{Bever2010}。
	然而，低均匀度的群落往往表现出较高的种间差异和较强的物种间竞争，这种竞争有时能够抑制病原的扩散，减少病害的传播。
	因此，物种均匀度的变化在不同生态系统中的作用可能有所不同，且其对病害的影响也受到其他生态因子，如病原种类、植物抗性、气候变化等因素的共同调节。
	综上所述，物种均匀度对植物病害的发生具有复杂而多样的影响。
	在某些情况下，高均匀度能够抑制病害的传播，而在其他情况下，可能会促进病原的扩散。不同生态系统和环境中的物种均匀度变化，需要结合具体的物种特性和生态互作来全面理解其对病害发生的影响\cite{Pautasso2010,Maron2011}。
	
	
	\section{拟解决的科学问题和技术路线}
	本文拟解决的科学问题主要集中在植物病害的发生规律及其与环境因素的关系上。
	一个核心问题是如何通过数据整合和建模技术，构建一个准确的植物病害预测模型。
	目前，尽管已有一些植物病害预测模型，但这些模型大多依赖于传统的统计分析方法或基于经验的数据，缺乏对气候变化、植物多样性以及生态系统复杂性的深入分析。
	因此，建立一个能够综合考虑气候变化、物种组成、病原传播等多种因素的植物病害预测模型，是一个亟待解决的关键问题。
	另一个关键问题是如何揭示植物病害的空间分布和时间变化规律。
	通过对历史病害发生数据进行空间和时间分析，结合气候、土壤、地理位置等环境因素，我们能够更好地理解植物病害的空间分布模式和时间变化趋势。
	这一分析不仅有助于识别潜在的病害高发区域，而且能为病害防控提供重要的科学依据。
	随着气候变化的加剧，气候因素对植物病害的影响愈加显著，因此，如何通过预测模型评估气候变化对植物病害的影响成为了一个迫切需要解决的科学问题。
	在气候变暖的背景下，某些植物病害的传播风险可能增加，研究气候变化对病害发生的潜在影响，将为有效的病害防控策略提供理论支持。
	
	
		为了解决上述问题，本文的技术路线包括了多个关键步骤。首先，数据采集与整合是模型构建的基础。
		我们创建了一个数据流图，展示了从数据集到机器学习模型的流程。图表中展示了两个主要数据源：WorldClim v2.0 和 HWSD v1.2，分别提供气候和土壤变量。数据集与这些变量通过经纬度匹配，以便进一步分析并与中国植物病害数据关联。这些气候和土壤数据在图中分别与“气候变量”和“土壤变量”节点相连接，接着它们被引入到“植物病害数据”节点，最终推动机器学习模型的建立。		
		
		
%		\begin{figure}[H]  % 创建浮动体（figure）
%			\centering  % 图片居中
%			\caption{构建植物病害预测分析的数据流程图}
%			\caption*{Data Flow Diagram for Constructing Plant Disease Prediction Analysis}
%			
%			
%			\includegraphics[width=0.8\textwidth]{pic/flowchart.png}  
%			
%			\label{fig:example}  % 设置标签，可以用于交叉引用
%		\end{figure}\item 
	将通过与实际病害发生数据的比对来检验模型的预测能力，并在此基础上不断调整和优化模型参数，提高预测的准确性。
	然后，借助建立的预测模型，我们将分析植物病害的空间分布规律和时间变化趋势，揭示气候变化、植物多样性等因素对病害发生的影响机制。
	随着气候变化的不断演变，未来的气候情境对植物病害的影响不可忽视。
	因此，本文还将结合未来气候变化情境进行模拟，分析气候变化对植物病害发生的潜在影响，预测不同气候条件下植物病害的发展趋势。
	通过这一技术路线，本文旨在为植物病害的预测与防控提供科学依据，帮助农业生产者有效应对气候变化带来的潜在挑战，并推动可持续农业管理和生态安全的实现。


	\chapter{数据来源}
	\section{获取原始数据}
	\subsection{收集WorldClim数据}
	
	为了量化每个研究样点的气候数据，我们根据每个样点的坐标从全球气候
	数据库中 Worldclim version 2.1（http://www.worldclim.org; ~1 千米分辨率; Fick 
	\& Hijmans, 2017 ） 提 取 了 每 个 样 点 的 年 平 均 气 温 （ MAT, mean annual 
	temperature）、年平均降水量（MAP, mean annual precipitation）、气温季节性
	（ TSEA, temperature seasonality ）和降水季节性（ PSEA, precipitation 
	seasonality）。
	
	\subsection{收集土壤数据}
	为了量化每个研究样点的土壤数据，我们根据每个样点的坐标从全球协调世界土壤数据库（HWSD）提取了
	土壤砂含量 (SoilSand)、表层土壤砂含量 (TopsoilSand)、表层土壤参考容重 (TopsoilReferenceBulkDensity)、
	土壤黏土含量 (SoilClay)等。
	
	
	\subsection{下载cmip6数据}

	首先，确保安装和加载所需的R包，使用\texttt{remotes}包\cite{remotes}来从GitHub安装\texttt{geodata}包\cite{geodata}。在加载\texttt{geodata}包后，使用\texttt{getwd()}获取当前工作目录，并通过\texttt{setwd()}设置工作目录为\texttt{"C:/Users/r/Desktop/cmip6"}，以便后续数据下载和存储都在该目录下。接下来，定义模型、情景和变量。这里仅指定一个模型\texttt{"ACCESS-CM2"}，并设置情景为\texttt{"126"}、\texttt{"245"}、\texttt{"370"}和\texttt{"585"}，选择需要下载的变量\texttt{"tmin"}、\texttt{"tmax"}、\texttt{"prec"}和\texttt{"bioc"}。时间范围设定为\texttt{"2021-2040"}、\texttt{"2041-2060"}、\texttt{"2061-2080"}和\texttt{"2081-2100"}，并指定数据保存路径为\texttt{"CMIP6"}。
	
	我们定义了一个名为\texttt{download\_data}的函数，该函数接受模型、情景和时间范围作为参数。在函数内部，根据模型和情景构建文件夹路径，然后针对每个变量构建文件名和下载URL。最后，使用嵌套循环遍历模型、情景和时间范围，调用\texttt{download\_data}函数进行数据下载。通过这一系列步骤，可以有效地批量下载指定模型和情景下的气候数据，并将数据保存在指定的目录结构中。
	
	
	\subsection{植物病害的基础信息的掌握}

	在中国草地的实地调查中，共收集了 193个样点 的植物病害数据。这些样点分布在 26个省级行政区 中，数据量以甘肃省和云南省最多（各13条），其次为河北省（12条）和陕西省（11条）。每个样点包含 3-4个样方，共计记录了 770条详细数据。
	
	
	\section{获取样点的基本信息}
	
	\subsection{方法}

	每条数据都记录了样点的经纬度信息以及植物病害的严重程度。这些详实的数据为后续植物病害的空间分布分析、影响因素研究以及防治策略制定提供了宝贵的基础资料。
	从一个包含经纬度数据的 Excel 文件中，获取每个地点的省、市和县信息，并将结果保存到一个 CSV 文件中。
	首先，通过 pandas 读取 Excel 文件，并将列名转换为小写，以便后续处理。
	
	接下来，代码在 DataFrame 中新增三列：Province（省份）、City（城市）和 District（县），这些列将用来存储后续通过地理编码获取的位置信息。然后，代码通过循环遍历每一行数据，获取每个地点的经纬度。对于每一行数据，调用 regeo 函数，传入经纬度，获取返回的地址信息。regeo 函数返回的是一个包含地址的字典，代码从中提取出省份、城市和县的信息，并更新到 DataFrame 对应的行。如果在获取过程中出现错误或返回的状态不正常，相关字段会被标记为 'undefined'。
	我们用pandas 库读取选择了包含降水和气温数据的特定列。然后，从中提取了经纬度信息以及降水和气温的相关数据，并计算了每个样本的降水总量（通过将每个月的降水量求和）和气温的平均值（通过计算每个月气温的平均值）。接着，移除了经纬度重复的行，只保留了首次出现的值。
	在可视化部分，使用了 matplotlib 库创建了一个包含主散点图和直方图的复合图。散点图展示了气温的平均值和降水总量之间的关系，气温值位于 x 轴，降水总量位于 y 轴。为了辅助理解数据的分布，图形的顶部和右侧分别添加了气温和降水的直方图，其中气温直方图位于顶部，降水直方图则位于右侧，并且这些直方图的轴与散点图共享。
	这段代码使用了 geopandas 和 matplotlib 等库来处理并可视化地理数据。我们创建了一个 GeoDataFrame 来表示样点数据，并使用 Albers 投影坐标系进行转换，这样可以更适合地展示区域数据。代码随后将 GeoJSON和样点数据转换到统一的 Albers 投影坐标系，并将这些数据绘制到一个地图上。
	
	\subsection{结果}
	
	通过这张图可以看到研究地区分布于我国东南部的各个省市，且分布比较平均。
	高气温的数据往往也有高降水，气温和降水之间的关系不是简单的线性关系，
	而是有一定的非线性相关，温度较低的区间，气温增加对于降水的影响较小，
	而温度较高的区间，气温对降水的影响较大。
	
%	\begin{figure}[H]  % 创建浮动体（figure）
%		\centering  % 图片居中
%		\includegraphics[width=0.8\textwidth]{pic/sample.png}  % 插入图片，指定宽度为页面宽度的80%
%		\caption{中国地区的771个样点的样点分布图}
%		\caption*{Point Distribution Map of 771 Sample Points in China}
%		\label{fig:example}  % 设置标签，可以用于交叉引用
%	\end{figure}
	
%	\begin{figure}[H]  % 创建浮动体（figure）
%		\centering  % 图片居中
%		\includegraphics[width=0.8\textwidth]{pic/scatter_with_histograms.png}  % 插入图片，指定宽度为页面宽度的80%
%		\caption{中国地区的771个样点降水与气温的散点直方图}
%		\caption*{Scatter and Histogram of Precipitation and Temperature for 771 Sample Points in China}
%		\label{fig:example}  % 设置标签，可以用于交叉引用
%	\end{figure}
	
	\begin{table}[H]
		\centering
		\caption{中国地区的771个样点的省市分布}
		\caption*{Province and City Distribution of 771 Sample Points in China}
		\begin{tabular}{ll|ll}
			\toprule
			\textbf{类别} & \textbf{计数} & \textbf{类别} & \textbf{计数} \\
			\midrule
			甘肃省 & 13 & 吉林省 & 9 \\
			云南省 & 13 & 山东省 & 9 \\
			河北省 & 12 & 河南省 & 9 \\
			陕西省 & 11 & 湖北省 & 9 \\
			黑龙江省 & 11 & 湖南省 & 9 \\
			贵州省 & 10 & 内蒙古自治区 & 8 \\
			广西壮族自治区 & 10 & 江苏省 & 8 \\
			广东省 & 10 & 安徽省 & 8 \\
			山西省 & 7 & 四川省 & 8 \\
			江西省 & 7 & 新疆维吾尔自治区 & 6 \\
			福建省 & 7 & 浙江省 & 5 \\
			辽宁省 & 4 & 重庆市 & 4 \\
			海南省 & 4 & 宁夏回族自治区 & 2 \\
			\bottomrule
		\end{tabular}
		
		\label{tab:category_count}
	\end{table}
	
	
	统计结果显示，各个省份和自治区在数据中的出现频次有所不同。
	甘肃省和云南省的数据量最大，每个省份分别出现了13次，其次是河北省，出现了12次。
	陕西省和黑龙江省分别出现了11次，位居第三。贵州省、广西壮族自治区和广东省的出现次数均为10次，紧随其后。
	其他省份如吉林省、山东省、河南省、湖北省和湖南省的出现次数为9次，显示出它们在数据中的较高频次。
	内蒙古自治区和江苏省的频次为8次，而安徽省和四川省则分别为8次，表明这些省份在数据中的频次也较为集中。
	山西省、江西省和福建省的出现次数为7次，相对较少。新疆维吾尔自治区的出现次数为6次，而浙江省为5次，
	显示出它们在该数据集中的出现频次较低。
	辽宁省、重庆市、海南省和宁夏回族自治区的出现次数则较少，分别为4次和2次，显示出这些地区在数据中的比例较小。总体来看，数据集中不同省份和自治区的分布存在一定的差异，部分省份的数据频次较高，而其他省份的频次则相对较低。
	
	
	\section{数据的预处理}
	
	在特征处理环节中，为了一些气候变量构建综合指标，
	代码对以特定前缀命名的列（如 \texttt{prec\_} 表示降水量）进行了求和操作，将结果存储为新变量（如 \texttt{MAP} 表示年均降水量）。类似地，对于其他气候变量，如 \texttt{wind\_}、\texttt{tmax\_}、\texttt{tmin\_} 和 \texttt{tavg\_}，分别计算了总和或平均值，并生成了新的变量，例如 \texttt{WIND}（总风速）、\texttt{MAXMAT}（最大平均气温）、\texttt{MINMAT}（最小平均气温）和 \texttt{AVGMAT}（平均气温）。此外，还处理了变量 \texttt{srad\_} 和 \texttt{vapr\_}，分别生成了代表辐射和蒸汽压力总和的变量 \texttt{SRAD} 和 \texttt{VAPR}。生成这些综合指标后，原始的气候相关列被移除，以减少冗余。
	
	完成变量构造后，代码进一步清理了数据，删除了一些不需要的列（如 \texttt{REF\_DEPTH}、\texttt{LANDMASK}、\texttt{ROOTS} 和 \texttt{ISSOIL}），并将剩余列名统一转化为大写格式。最后，将目标变量 \texttt{RATIO} 与其他特征分离，准备用于模型训练和测试。在建模阶段，代码首先将数据分为训练集和测试集（比例为 7:3），并使用随机森林回归模型作为基模型。为了进一步提升特征选择的科学性与稳健性，代码使用了 \texttt{} 算法对训练集特征进行重要性排序 \cite{kursa2010feature}，Boruta
	
	
	我们计算了 Spearman 相关系数矩阵并将其格式化为 LaTeX 表格，同时包含显著性标记和格式调整。接下来，代码分别计算了 Spearman 相关系数矩阵和对应的 p 值矩阵。相关系数矩阵的计算是通过 Pandas 的 corr 方法完成的，而 p 值矩阵则通过 scipy.stats.spearmanr 逐对计算得出。随后，代码对相关系数矩阵进行格式化处理，将每个相关系数保留两位小数，并根据值的正负性对其进行加粗。如果相关系数对应的 p 值小于 0.05，则在值后添加星号 * 以表示其显著性。为了只展示矩阵的下三角部分（不包括对角线），代码使用了一个掩码（mask）屏蔽掉矩阵的上三角部分，并提取出下三角部分的非空值。
	% Spearman 相关系数的计算公式
	\text{Spearman 相关系数}：
	\[
	\rho = 1 - \frac{6 \sum_{i=1}^{n} d_i^2}{n(n^2 - 1)}
	\]
	其中：
	- \( \rho \) 为 Spearman 相关系数；
	- \( d_i \) 为每一对数据点在排序后之差的平方；
	- \( n \) 为样本数量。
	
	% p 值的计算
	\text{Spearman 相关系数的 p 值}：
	\[
	p\text{-值} = P(\text{计算得到的相关系数} \geq \rho)
	\]
	p 值通常通过使用假设检验的方式进行计算，例如通过 scipy 中的 `spearmanr` 函数来实现逐对检验，得出每个相关系数对应的显著性水平。
	
	从表格可以看出，变量之间的相关性有显著差异。比如，经度（LON）与纬度（LAT）和多个气候、土壤变量之间存在显著的相关性。风速（WIND）与多个气候变量，如最大温度（MAX MAT）、平均温度（AVG MAT）等也有显著的相关性。同时，土壤类型（如沙土、粘土等）和气候、地理变量之间也有一定的关系，某些变量，如沙土（SAND）和砂土（S REF BULK），与响应变量表现出较强的负相关性。总体来说，该相关分析为理解气候、地理与土壤因素如何影响响应变量提供了重要的定量信息。
	
	为了分析自变量和因变量之间的关系，我们计算了自变量与因变量之间的距离矩阵，采用欧几里得距离度量。在此基础上，我们定义了一个 mantel\_test 函数，计算了自变量和因变量的距离矩阵之间的 Pearson 相关系数和 p 值，来评估它们之间的空间相关性。通过遍历每个自变量列，我们完成了每个自变量与因变量的 Mantel 检验，并将结果保留为两位小数，同时对 p 值小于 0.05 的结果进行加粗显示，表示其具有显著性。
	
	大多数气候和土壤变量与响应变量之间具有显著的相关性，特别是太阳辐射 (SRAD)、土壤砂含量 (S SAND)、气压 (VAPR)、海拔 (ELEV)、纬度 (LAT) 等与植物病害之间的相关性显示出非常显著的负相关关系。另一方面，风速 (WIND) 和表层土壤砾石含量 (T GRAVEL) 与响应变量之间的相关性并不显著，p 值较高，分别为 0.38 和 0.89。这些结果表明，在这些变量中，有些与植物病害存在较强的负相关关系，而有些则与植物病害的关系较弱或不显著。
	
	

	% Mantel 检验的 p 值
	\text{Mantel 检验的 p 值}：
	\[
	p\text{-值} = P(\text{随机排列的相关系数} \geq \text{计算得到的相关系数})
	\]
	如果 \( p\text{值} < 0.05 \)，则认为自变量和因变量之间具有显著的空间相关性。在遍历每个自变量列时，我们计算每个自变量与因变量之间的 Mantel 检验，并将结果保留为两位小数。对于 \( p\text{值} < 0.05 \) 的结果，我们进行加粗显示，表示其具有显著性。
	\begin{table}[H]
		\caption{中国地区的771个样点的17个气候、地理与土壤变量的统计值。这些变量包括了经度 (Longitude)、纬度 (Latitude)、
			海拔 (Elevation)、太阳辐射 (SolarRadiation)、降水季节性(PSEA)、气温季节性(PSEA)、土壤砂含量 (SoilSand)、
			气压 (VaporPressure)、风速 (WindSpeed)、最大温度 (MaximumTemperature)、平均温度 (AverageTemperature)、
			最小温度 (MinimumTemperature)、年均降水量 (MeanAnnualPrecipitation)、表层土壤砂含量 (TopsoilSand)、表层土壤实际容重(Topsoil Bulk Density)、表层土壤参考容重 (TopsoilReferenceBulkDensity)、土壤黏土含量 (SoilClay)。}
		\caption*{The statistics of climate, geographical, and soil variables for 771 sample points in China, including Longitude, Latitude, Elevation, Solar Radiation, Soil Sand Content, Vapor Pressure, Wind Speed, Maximum Temperature, Average Temperature, Minimum Temperature, Mean Annual Precipitation, Topsoil Sand Content, Soil Reference Bulk Density, Topsoil Reference Bulk Density, Soil Clay Content, and Topsoil Gravel Content.}
		
		\label{tab:range}
		\begin{tabular}{lllll}
			\toprule
			Variable (Unit) & Simplified Name & Mean & Std Dev & Range \\
			\midrule
			SRAD (W/$m^2$) & Solar Radiation & 14470.63 & 1171.5 & 10799.58 - 16821.33 \\
			S SAND (\%) & Soil Sand & 37.97 & 14.11 & 0.00 - 90.00 \\
			LON ($ ^\circ E$)& Longitude & 114.0 & 6.93 & 99.88 - 130.82 \\
			PSEA (mm)& Precipitation Seasonality & 82.12 & 23.32 & 41.31 - 148.33 \\
			WIND (m/s)& Wind Speed & 2.3 & 0.65 & 1.12 - 4.27 \\
			VAPR(kPa) & Vapor Pressure & 1.34 & 0.43 & 0.49 - 2.28 \\
			MAX MAT ($ ^\circ C$) & Maximum Temperature & 18.61 & 4.64 & 4.00 - 28.19 \\
			ELEV (m) & Elevation & 469.74 & 529.79 & 0.00 - 2529.00 \\
			TSEA ($ ^\circ C$) & Temperature Seasonality & 909.45 & 286.13 & 337.74 - 1645.90 \\
			MIN MAT ($ ^\circ C$) & Minimum Temperature & 8.98 & 6.17 & -8.15 - 19.91 \\
			LAT ($ ^\circ N$)& Latitude & 32.67 & 7.02 & 21.57 - 48.83 \\
			MAP (mm) & MeanAnnual Precipitation & 996.48 & 440.85 & 294.00 - 2205.00 \\
			AVG MAT ($ ^\circ C$)  & Average Temperature & 13.79 & 5.36 & -2.08 - 23.24 \\
			T SAND (\%) & Topsoil Sand & 39.61 & 15.58 & 10.00 - 89.00 \\
			T BULK DEN (g/$cm^3$)& Topsoil Bulk Density & 1.36 & 0.11 & 0.28 - 1.54 \\
			T REF BULK (g/$cm^3$)& Topsoil ReferenceBulk Density & 1.39 & 0.09 & 1.22 - 1.70 \\
			S CLAY (\%) & Soil Clay & 29.21 & 13.21 & 0.00 - 57.00 \\
			\bottomrule
		\end{tabular}
	\end{table}
	
	
	\begin{landscape}  % 开始横置页面
		\thispagestyle{empty}
		\begin{table}[H]
			
			
			\caption{17个气候、地理与土壤变量的与响应变量之间的Spearman相关分析结果。每个相关系数保留两位小数，并根据值的正负性对其进行加粗。如果相关系数对应的 p 值小于 0.05，则在值后添加星号 * 以表示其显著性。}
			\caption*{Results of Spearman correlation analysis between 17 climate, geographic, and soil variables and the response variable. Each correlation coefficient is rounded to two decimal places and bolded based on its sign (positive or negative). If the p-value corresponding to a correlation coefficient is less than 0.05, an asterisk (*) is added after the value to indicate its significance.}
			\label{tab:correlation_matrix}                                
			\tiny                                                         
			\begin{tabular}{p{1.6cm}p{0.68cm}p{0.68cm}p{0.68cm}p{0.68cm}p{0.68cm}p{0.68cm}p{0.68cm}p{0.68cm}p{0.68cm}p{0.68cm}p{0.68cm}p{0.68cm}p{0.68cm}p{0.68cm}p{0.68cm}p{0.68cm}p{0.68cm}}
							\toprule
				\multicolumn{1}{c}{Spearman r}  & \textbf{SRAD} & \textbf{LON} & \textbf{S} \par \textbf{SAND} & \textbf{WIND} & \textbf{VAPR} & \textbf{ELEV} & \textbf{LAT} & \textbf{MAX} \par \textbf{MAT} & \textbf{AVG} \par \textbf{MAT} & \textbf{MIN} \par \textbf{MAT} & \textbf{MAP} & \textbf{T} \par \textbf{SAND} & \textbf{MU} \par \textbf{GLOBAL} & \textbf{T} \par \textbf{REF} \par \textbf{BULK} & \textbf{S} \par \textbf{CLAY} & \textbf{S} \par \textbf{REF} \par \textbf{BULK} & \textbf{T} \par \textbf{GRAVEL} \\
							\midrule
				\textbf{S SAND} & 0.19* &  &  &  &  &  &  &  &  &  &  &  &  &  &  &  &  \\
				\textbf{LON} & 0.23* & 0.09* &  &  &  &  &  &  &  &  &  &  &  &  &  &  &  \\
				\textbf{PSEA} & 0.37* & 0.27* & 0.22* &  &  &  &  &  &  &  &  &  &  &  &  &  &  \\
				\textbf{WIND} & 0.43* & 0.16* & 0.82* & 0.38* &  &  &  &  &  &  &  &  &  &  &  &  &  \\
				\textbf{VAPR} & \textbf{-0.09}* & \textbf{-0.18}* & \textbf{-0.32}* & \textbf{-0.73}* & \textbf{-0.44}* &  &  &  &  &  &  &  &  &  &  &  &  \\
				\textbf{MAX MAT} & 0.04 & \textbf{-0.15}* & \textbf{-0.41}* & \textbf{-0.61}* & \textbf{-0.49}* & 0.93* &  &  &  &  &  &  &  &  &  &  &  \\
				\textbf{ELEV} & \textbf{-0.31}* & \textbf{-0.10}* & \textbf{-0.58}* & 0.09* & \textbf{-0.47}* & \textbf{-0.25}* & \textbf{-0.18}* &  &  &  &  &  &  &  &  &  &  \\
				\textbf{TSEA} & 0.22* & 0.22* & 0.69* & 0.59* & 0.65* & \textbf{-0.80}* & \textbf{-0.81}* & \textbf{-0.26}* &  &  &  &  &  &  &  &  &  \\
				\textbf{MIN MAT} & \textbf{-0.11}* & \textbf{-0.18}* & \textbf{-0.40}* & \textbf{-0.71}* & \textbf{-0.50}* & 0.98* & 0.95* & \textbf{-0.19}* & \textbf{-0.84}* &  &  &  &  &  &  &  &  \\
				\textbf{LAT} & 0.15* & 0.25* & 0.57* & 0.68* & 0.58* & \textbf{-0.90}* & \textbf{-0.90}* & \textbf{-0.10}* & 0.96* & \textbf{-0.92}* &  &  &  &  &  &  &  \\
				\textbf{MAP} & \textbf{-0.27}* & \textbf{-0.29}* & \textbf{-0.27}* & \textbf{-0.77}* & \textbf{-0.44}* & 0.91* & 0.83* & \textbf{-0.11}* & \textbf{-0.80}* & 0.90* & \textbf{-0.88}* &  &  &  &  &  &  \\
				\textbf{AVG MAT} & \textbf{-0.05} & \textbf{-0.17}* & \textbf{-0.41}* & \textbf{-0.67}* & \textbf{-0.50}* & 0.97* & 0.98* & \textbf{-0.17}* & \textbf{-0.84}* & 0.99* & \textbf{-0.92}* & 0.88* &  &  &  &  &  \\
				\textbf{T SAND} & 0.18* & 0.90* & 0.05 & 0.28* & 0.10* & \textbf{-0.19}* & \textbf{-0.15}* & \textbf{-0.02} & 0.20* & \textbf{-0.19}* & 0.23* & \textbf{-0.27}* & \textbf{-0.17}* &  &  &  &  \\
				\textbf{T BULK DEN} & 0.24* & 0.30* & 0.04 & 0.16* & 0.13* & \textbf{-0.14}* & \textbf{-0.11}* & \textbf{-0.13}* & 0.20* & \textbf{-0.13}* & 0.19* & \textbf{-0.22}* & \textbf{-0.14}* & 0.32* &  &  &  \\
				\textbf{T REF BULK} & 0.30* & 0.78* & 0.07* & 0.33* & 0.15* & \textbf{-0.28}* & \textbf{-0.23}* & \textbf{-0.08}* & 0.29* & \textbf{-0.27}* & 0.33* & \textbf{-0.40}* & \textbf{-0.26}* & 0.80* & 0.42* &  &  \\
				\textbf{S CLAY} & \textbf{-0.19}* & \textbf{-0.48}* & \textbf{-0.16}* & \textbf{-0.22}* & \textbf{-0.22}* & 0.27* & 0.25* & 0.22* & \textbf{-0.36}* & 0.26* & \textbf{-0.36}* & 0.39* & 0.26* & \textbf{-0.27}* & \textbf{-0.37}* & \textbf{-0.62}* &  \\
				\textbf{PL} & \textbf{-0.23}* & \textbf{-0.07} & 0.05 & \textbf{-0.05} & \textbf{-0.02} & \textbf{-0.06} & \textbf{-0.10}* & 0.01 & 0.05 & \textbf{-0.06} & 0.06 & \textbf{-0.01} & \textbf{-0.08}* & \textbf{-0.08}* & \textbf{-0.04} & \textbf{-0.12}* & 0.07 \\
							\bottomrule
			\end{tabular}
		\end{table}
	\end{landscape}  % 结束横置页面
	
	
%	\begin{figure}[H]  % 创建浮动体（figure）
%		\centering  % 图片居中
%		\caption{带有数值标注的相关矩阵热图}
%		\caption*{Correlation Matrix Heatmap with Numerical Annotations}
%		
%		\includegraphics[width=0.8\textwidth]{pic/COR.png}  
%		
%		\label{fig:example}  % 设置标签，可以用于交叉引用
%	\end{figure}
	
	\begin{table}[H]
		\centering
		\caption{17个气候、地理与土壤变量的与响应变量之间的Mantel检验结果。这些因子包括经度 (Longitude)、纬度 (Latitude)、海拔 (Elevation)、太阳辐射 (SolarRadiation)、土壤砂含量 (SoilSand)、气压 (VaporPressure)、风速 (WindSpeed)、最大温度 (MaximumTemperature)、平均温度 (AverageTemperature)、最小温度 (MinimumTemperature)、年均降水量 (MeanAnnualPrecipitation)、表层土壤砂含量 (TopsoilSand)、表层土壤参考容重 (TopsoilReferenceBulkDensity)、土壤黏土含量 (SoilClay)。表中显示了各因子与响应变量之间的相关系数，其中显著的以粗体显示。}
		\caption*{Mantel test results between 17 climate, geographic, and soil variables and the response variable. These factors include Longitude, Latitude, Elevation, Solar Radiation, Soil Sand CoHntent, Vapor Pressure, Wind Speed, Maximum Temperature, Average Temperature, Minimum Temperature, Mean Annual Precipitation, Topsoil Sand Content, Soil Reference Bulk Density, Topsoil Reference Bulk Density, Soil Clay Content, and Topsoil Gravel Content. The table shows the correlation coefficients between each factor and the response variable, with significant results displayed in bold.}
		\begin{tabular}{cccc}
			\toprule
			spec.variable & env.variable & Mantel r & p-value \\
			\midrule
			Plant Disease & SRAD & 0.06 & \textbf{0.0} \\
			Plant Disease & S SAND & 0.08 & \textbf{0.0} \\
			Plant Disease & LON & -0.00 & \textbf{0.04} \\
			Plant Disease & PSEA & -0.00 & 0.80 \\
			Plant Disease & WIND & 0.00 & 0.38 \\
			Plant Disease & VAPR & -0.03 & \textbf{0.0} \\
			Plant Disease & MAX MAT & -0.00 & 0.25 \\
			Plant Disease & ELEV & -0.02 & \textbf{0.0} \\
			Plant Disease & TSEA & -0.02 & \textbf{0.0} \\
			Plant Disease & MIN MAT & -0.02 & \textbf{0.0} \\
			Plant Disease & LAT & -0.01 & \textbf{0.0} \\
			Plant Disease & MAP & -0.02 & \textbf{0.0} \\
			Plant Disease & AVG MAT & -0.01 & \textbf{0.0} \\
			Plant Disease & T SAND & 0.03 & \textbf{0.0} \\
			Plant Disease & T BULK DEN & -0.01 & \textbf{0.0} \\
			Plant Disease & T REF BULK & 0.05 & \textbf{0.0} \\
			Plant Disease & S CLAY & 0.08 & \textbf{0.0} \\
			\bottomrule
		\end{tabular}
	\end{table}
	

	\chapter{模型构建}
	
	\section{地理信息处理方式}
	
	本文的地理信息处理方式依赖于GDAL库 \cite{gdal2020}。
	GDAL（Geospatial Data Abstraction Library）是一个开源的地理空间数据处理库，广泛应用于地理信息系统（GIS）领域，具有强大的数据读写和处理功能 \cite{mitchell1999}。
	GDAL支持多种栅格和矢量数据格式，如GeoTIFF、Shapefile、KML、GeoJSON等，使其能够在不同的数据格式之间进行转换和处理，这为数据的集成和分析提供了极大的便利。
	此外，GDAL的跨平台特性使得它能够在Windows、Linux、macOS等多种操作系统上运行，确保了它的广泛适用性。
	GDAL还提供了高效的性能，特别是在处理大规模数据时，它能快速读取、写入以及进行各种数据处理操作，如投影转换、栅格运算和矢量数据的操作等。
	
	在C语言中调用GDAL时，首先需要安装并包含GDAL的头文件。通过使用GDALAllRegister()函数注册数据驱动后，可以使用GDALOpen()函数打开文件，并通过GDALGetRasterBand()等API访问数据。
	处理完数据后，需要使用GDALClose()释放资源。C语言的GDAL接口功能全面，适合性能要求高、底层控制需求强的应用。
	
	在Python中调用GDAL相对简单，首先需要通过pip安装GDAL库，然后通过 \texttt{from osgeo import gdal} 导入相关模块 \cite{osgeo}。使用Python的gdal.Open()函数打开文件后，可以通过GetRasterBand()访问栅格数据，并使用ReadAsArray()等函数获取像素值。Python接口具有更为友好的语法和开发效率，适合快速开发和原型设计，但依然保留了GDAL的强大功能。无论是C语言还是Python，GDAL都能提供强大的地理空间数据处理能力，满足不同开发需求。

	\section{相关系数}
	相关系数是一个度量两个变量间线性关系强度和方向的统计指标，通常用符号 \( r \) 表示，其值范围在 -和 1 之间。正的相关系数表示两个变量正相关，即当一个变量增加时，另一个变量也趋于增加；而负的相关系数表示负相关，即一个变量增加的同时另一个变量减少。值为0的相关系数表示两个变量之间没有线性关系。相关系数的计算公式为：
	
	\[
	r = \frac{\sum_{i=1}^{n} (x_i - \overline{x})(y_i - \overline{y})}{\sqrt{\sum_{i=1}^{n} (x_i - \overline{x})^2} \cdot \sqrt{\sum_{i=1}^{n} (y_i - \overline{y})^2}}
	\]
	
	其中 \( x_i \) 和 \( y_i \) 分别表示第 \( i \) 个观测值，\( \overline{x} \) 和 \( \overline{y} \) 是 \( x \) 和 \( y \) 的均值，\( n \) 为观测值的总数。该公式分子计算 \( x \) 和 \( y \) 偏离均值的乘积之和，而分母是两个变量偏离均值平方和的平方根相乘，从而将度量标准化。
	
	\text{欧几里得距离}：
	\[
	d_{ij} = \sqrt{\sum_{k=1}^{n} (x_{ik} - x_{jk})^2}
	\]
	其中：
	- \( d_{ij} \) 为自变量或因变量中第 \(i\) 和第 \(j\) 个样本点之间的距离；
	- \( x_{ik} \) 和 \( x_{jk} \) 为自变量或因变量中第 \(i\) 和第 \(j\) 个样本点在第 \(k\) 个变量上的值；
	- \( n \) 为变量的总数。
	
	% Pearson 相关系数公式
	\text{Pearson 相关系数}：
	\[
	r = \frac{\sum_{i=1}^{m} (d_{Xi} - \bar{d_X})(d_{Yi} - \bar{d_Y})}{\sqrt{\sum_{i=1}^{m} (d_{Xi} - \bar{d_X})^2 \sum_{i=1}^{m} (d_{Yi} - \bar{d_Y})^2}}
	\]
	其中：
	- \( d_{Xi} \) 和 \( d_{Yi} \) 为自变量和因变量中第 \(i\) 个样本点的距离；
	- \( \bar{d_X} \) 和 \( \bar{d_Y} \) 为自变量和因变量距离矩阵的均值；
	- \( m \) 为样本点的总数。



	\section{贝叶斯回归模型}
	贝叶斯回归模型是一种基于贝叶斯定理的统计推断方法，广泛应用于回归分析中，特别是在处理带有不确定性的数据时 \cite{bishop2006pattern}。
	贝叶斯回归的核心思想是将回归问题转化为对模型参数的概率推断，而不是通过点估计来确定参数值 \cite{gelman2013bayesian}。
	具体来说，贝叶斯回归通过引入先验分布，结合观测数据，通过后验分布来推断未知参数。
	给定数据集 $\{(x_i, y_i)\}_{i=1}^N$，贝叶斯回归模型的目标是通过最大化后验分布来估计参数。
	
	贝叶斯回归的基本公式如下所示：
	
	\[
	P(\theta | D) = \frac{P(D | \theta) P(\theta)}{P(D)}
	\]
	
	其中，$\theta$ 是回归模型的参数，$D = \{(x_i, y_i)\}_{i=1}^N$ 是观测数据，$P(D | \theta)$ 是似然函数，$P(\theta)$ 是先验分布，$P(D)$ 是数据的边际似然。在贝叶斯回归中，后验分布 $P(\theta | D)$ 描述了在给定数据的条件下模型参数的分布。常见的回归模型包括线性回归模型，其中假设响应变量 $y_i$ 与输入变量 $x_i$ 之间的关系为：
	
	\[
	y_i = x_i^\top \theta + \epsilon_i
	\]
	
	其中，$\epsilon_i \sim \mathcal{N}(0, \sigma^2)$ 是误差项，$\theta$ 是回归系数。为了简化推断，通常使用高斯分布作为似然函数，且先验分布也选择高斯分布，以便通过计算后验分布得到闭式解。在实践中，可以通过最大后验估计（MAP）来估计模型参数，即通过优化以下目标函数来获得参数的最佳估计：
	
	\[
	\hat{\theta}_{MAP} = \arg\max_\theta P(\theta | D) = \arg\max_\theta P(D | \theta) P(\theta)
	\]
	
	贝叶斯回归的一个显著优势是能够量化预测的不确定性，这对于需要高可靠性预测的应用尤其重要。
	在模型训练过程中，贝叶斯回归通过结合先验信息和数据观测，不仅能够提供点估计，还能给出预测的不确定度，通常用后验分布的方差来度量。
	
	此外，贝叶斯回归在应对复杂的、非线性的问题时，常常与其他方法结合使用。
	例如，基于核方法的贝叶斯回归（如高斯过程回归）通过使用核函数来处理非线性回归问题。
	高斯过程回归的核心思想是利用高斯过程作为先验，并通过观测数据更新后验，从而实现对非线性函数的建模。
	
	在实际应用中，贝叶斯回归广泛应用于多个领域，包括生物学 \cite{biology_bayes}、金融学 \cite{finance_bayes}、工程学以及人工智能等。
	例如，在金融市场中，贝叶斯回归被用于风险预测和资产定价问题 \cite{finance_bayes_risk}。
	通过对历史数据的学习，贝叶斯回归模型能够为未来的股市波动、利率变化等提供不确定性评估 \cite{finance_bayes_volatility}。
	类似地，在生物学领域，贝叶斯回归模型被用来处理环境数据、基因表达分析等问题，这些问题往往伴随着大量的噪声和不确定性 \cite{biology_bayes_noise}。
	
	
	贝叶斯回归的计算复杂度通常较高，特别是在参数空间较大时，需要使用近似方法如马尔科夫链蒙特卡洛（MCMC）方法进行推断。
	尽管如此，近年来由于计算能力的提升和新算法的发展，贝叶斯回归已经成为处理不确定性和复杂数据结构的重要工具。
	
	总体而言，贝叶斯回归模型为回归分析提供了一种强有力的框架，特别是在处理具有不确定性、噪声较大的数据时，它能够充分利用先验知识并提供不确定性度量，这使得其在许多领域中得到了广泛的应用。贝叶斯方法已被应用于植物病害预测，使得在存在不确定性的情况下仍能进行稳健建模。\citet{yuen2002bayesian} 的研究展示了贝叶斯分析在该领域的有效性。
	
	\section{结构方程模型}
	
	构方程模型（Structural Equation Modeling，简称 SEM）是一种用于分析变量之间复杂关系的统计方法。它通过同时估计多个回归关系，以探讨潜在变量（即不可直接观测的变量）与观测变量之间的关系，提供了对因果推断的量化分析。SEM广泛应用于心理学、社会科学、市场营销、教育研究等领域，能够处理多个依赖关系、多个因果路径和测量误差等复杂情形。
	
	结构方程模型的基本框架包括两个主要部分：测量模型和结构模型。测量模型用于描述潜在变量与观测变量之间的关系，通常通过因子分析来构建。结构模型则用于描述潜在变量之间的因果关系。潜在变量通常是通过一组与之相关的观测变量来进行测量的，而测量误差会对变量间的关系产生影响，这一点在 SEM 中得到了明确的处理\cite{wang2010}。在 SEM 中，通常将模型分为两个部分：一是测量模型（Measurement Model），它描述了潜在变量与观测变量之间的关系，二是结构模型（Structural Model），它描述了潜在变量之间的因果关系。测量模型通常使用因子分析来建模，而结构模型则通过回归方程来表示因果关系\cite{byrne2010}。结构方程模型的数学表达式通常涉及到回归方程，潜在变量和观测变量之间的关系可以用以下的公式来表示：
	
	\[
	\mathbf{Y} = \mathbf{B} \mathbf{X} + \mathbf{E}
	\]
	
	其中，\(\mathbf{Y}\) 表示因变量（即观测变量），\(\mathbf{X}\) 表示自变量（即潜在变量或观测变量），\(\mathbf{B}\) 是回归系数，\(\mathbf{E}\) 是误差项。在结构方程模型中，潜在变量和观测变量的关系可以通过路径图（Path Diagram）来进行可视化。路径图中的箭头表示变量之间的因果关系，箭头的方向通常从自变量指向因变量\cite{byrne2010}。SEM 的优势之一是其能够处理潜在变量的测量误差，这使得它比传统的回归分析方法更为精确。此外，结构方程模型也能够处理多个依赖关系和多条因果路径，这是传统线性回归模型无法做到的。然而，SEM 也存在一定的局限性，例如模型的拟合程度较难评价，且模型的估计结果依赖于数据的质量和假设的合理性\cite{wang2010}。在实际应用中，SEM 的模型拟合通常通过最大似然估计（Maximum Likelihood Estimation，MLE）来实现。拟合优度指标如卡方检验（\(\chi^2\)）、比较拟合指数（CFI）、均方根误差近似（RMSEA）等被用来评估模型的拟合效果。例如，RMSEA值小于0.05表示模型拟合良好，CFI值大于0.90表示模型的拟合较好\cite{byrne2010}。


	\section{集成学习模型}
	
	\subsection{随机森林}
	
	随机森林（Random Forest）是一种集成学习方法，它通过构建多个决策树并结合其结果来进行分类或回归任务。该算法由Leo Breiman在2001年提出，旨在通过降低模型的方差来提高预测的准确性和鲁棒性。
	它通过构建多个决策树并将其结果进行结合，形成一个“森林”。
	每棵树是在随机抽样的训练数据上生成的，通常采用自助采样（Bootstrap Sampling）技术，即在训练集上随机抽取样本并放回，这样每棵树的训练数据略有不同，从而增强模型的多样性。
	此外，在每棵树的构建过程中，随机森林还会在每个节点上随机选择特征进行分裂，这进一步减少了树之间的相关性，有助于降低过拟合风险 \cite{breiman2001random}。
	该算法通过随机选取训练数据的子集和特征来生成每棵树，从而降低各棵树之间的相关性，提高模型的鲁棒性和准确性 \cite{liaw2002random}。
	随机森林具有良好的抗过拟合能力和较高的泛化性能，特别适用于处理高维数据和缺失值 \cite{ishwaran2008random}。

	它能够自动处理大规模数据集，并提供特征重要性评估，帮助理解和解释模型的决策过程。
	同时，随机森林易于并行化，能够有效利用现代计算资源。
	随机森林通过随机选取训练数据的子集和特征来生成每棵树，使得各棵树之间的相关性降低，从而提升整体模型的性能。每棵决策树独立生长，且不会进行修剪，最终通过多数表决或平均值来汇总各个树的预测结果。
	随机森林具有良好的抗过拟合能力和较高的泛化性能，尤其在处理高维数据和缺失值时表现优异。其主要优势在于能够自动处理大规模数据集，并提供特征重要性评估，帮助理解和解释模型的决策过程。
	随机森林易于并行化，能够有效利用现代计算资源，广泛应用于金融、医学、市场营销、图像识别等多个领域，能够处理各种类型的数据，包括数值型和分类型数据。
	在 Python 中，利用 \texttt{scikit-learn} 库 \cite{scikit-learn} 可以方便地实现随机森林模型，用户只需指定树的数量和其他参数，即可训练和评估模型 \cite{random_forest_sklearn}。
	总之，随机森林凭借其高效的性能和广泛的应用场景，成为了机器学习领域的重要工具之一。
	随机森林的优点在于其抗过拟合能力和高准确性。通过结合多个决策树的预测结果，随机森林通常能够提供更为稳定和准确的预测。同时，它还可以评估特征的重要性，使得特征选择过程更加直观。然而，随机森林也存在一些缺点，例如模型复杂性较高，训练和预测的时间成本相对较大，并且相比单棵决策树，其可解释性较差，难以直观理解模型的决策逻辑。
	Liu 等（2015）采用遥感影像数据，结合随机森林的强大特性，在复杂的地理环境下成功应用于中国东北地区的土地利用/覆盖进行分类，
	验证了随机森林在处理高维度特征数据时的优势\cite{liu2015}。
	Li 等（2016）在印度尼西亚的热带雨林地区进行的研究表明随机森林能够有效处理复杂的遥感影像数据并克服了传统分类方法中存在的过拟合问题\cite{li2016}。
	Zhang 等（2017）利用随机森林对中国上海市的城市土地利用变化进行了研究，展示了该算法在高分辨率遥感影像分类中的表现\cite{zhang2017}。
	此外，Gislason 等（2006）应用随机森林算法进行冰岛土地覆盖分类，提出了随机森林在处理遥感数据中的优势，尤其是在大尺度遥感影像数据的处理上，
	能够有效减少噪声对分类结果的影响，并提高了分类模型的稳健性\cite{gislason2006}。
	
	
	随机森林的变量重要性是一种衡量每个变量（或特征）对预测目标影响程度的统计指标。
	在随机森林中，变量重要性通常通过两种方法来计算：基于平均减少均方误差（Mean Decrease in MSE）和基于平均减少不纯度（Mean Decrease in Impurity）。
	这些方法利用随机森林中的决策树结构来评估变量的预测贡献。
	首先，基于平均减少不纯度的变量重要性使用决策树中每次分裂所带来的不纯度减少量来度量。对于一个特定的特征 \( X_j \)，不纯度减少量可通过以下公式求得：
	
	\[
	\text{Importance}(X_j) = \sum_{t \in T} \Delta I_t \cdot \mathbf{1}(X_j \text{ is used in } t)
	\]
	
	其中 \( T \) 表示随机森林中的所有树，\( \Delta I_t \) 为在树 \( t \) 中使用 \( X_j \) 进行分裂时所减少的不纯度（如基尼指数或熵），而 \( \mathbf{1}(X_j \text{ is used in } t) \) 是指示函数，表示在分裂时是否使用了特征 \( X_j \)。
	
	其次，基于平均减少均方误差的变量重要性是通过每次将一个特定特征的值随机打乱，并比较随机打乱前后的均方误差（MSE）变化量来计算的。
	如果在打乱特征 \( X_j \) 后，均方误差显著增大，说明该特征对预测有较高的重要性。其重要性可通过以下公式来表达：
	
	\[
	\text{Importance}(X_j) = \frac{1}{N} \sum_{i=1}^{N} \left[ \text{MSE}_{\text{permuted}}(X_j) - \text{MSE}_{\text{original}} \right]
	\]
	
	其中 \( N \) 是树的总数，\( \text{MSE}_{\text{permuted}}(X_j) \) 是在打乱 \( X_j \) 后的均方误差，\( \text{MSE}_{\text{original}} \) 是未打乱时的均方误差。通过比较 MSE 增量，我们可以评估特征 \( X_j \) 的重要性：若该特征的重要性较高，则在打乱后 MSE 会显著上升，反之亦然。
	
	总结而言，随机森林的变量重要性衡量了每个变量对模型决策的影响，通过树结构的不纯度减少和均方误差的敏感性，随机森林可以有效评估各特征在整体模型中的重要性。
	
	相关系数是一个度量两个变量间线性关系强度和方向的统计指标，通常用符号 \( r \) 表示，其值范围在 -1 和 1 之间。
	正的相关系数表示两个变量正相关，即当一个变量增加时，另一个变量也趋于增加；而负的相关系数表示负相关，即一个变量增加的同时另一个变量减少。
	值为 0 的相关系数表示两个变量之间没有线性关系。相关系数的计算公式为：
	
	\[
	r = \frac{\sum_{i=1}^{n} (x_i - \overline{x})(y_i - \overline{y})}{\sqrt{\sum_{i=1}^{n} (x_i - \overline{x})^2} \cdot \sqrt{\sum_{i=1}^{n} (y_i - \overline{y})^2}}
	\]
	
	其中 \( x_i \) 和 \( y_i \) 分别表示第 \( i \) 个观测值，\( \overline{x} \) 和 \( \overline{y} \) 是 \( x \) 和 \( y \) 的均值，\( n \) 为观测值的总数。该公式分子计算 \( x \) 和 \( y \) 偏离均值的乘积之和，而分母是两个变量偏离均值平方和的平方根相乘，从而将度量标准化。
	
	
	
	
	\subsection{XGBoost}

	XGBoost是一种基于决策树的机器学习算法，因其速度和性能在处理大规模数据和复杂问题时非常受欢迎 \cite{chen2016xgboost}。
	XGBoost通过优化损失函数和增加正则化项，减少过拟合风险，同时加速模型的训练过程。其关键特性之一是实现了并行计算，使得在处理大规模数据集时具有显著的速度优势。此外，XGBoost 还提供了多种灵活的参数配置，使得用户能够针对具体问题进行调优。该模型不仅适用于分类和回归任务，还在许多机器学习竞赛中表现出色，成为数据科学家和机器学习工程师的热门选择。由于其强大的性能和灵活性，XGBoost 广泛应用于金融、医疗、广告和推荐系统等多个领域，是现代机器学习中不可或缺的重要工具。然而，XGBoost 也有一些缺点。首先，它相较于其他简单的模型如线性回归，需要更多的时间和资源来训练，尤其是当数据量非常大时。其次，XGBoost的超参数调优较为复杂，错误的设置可能导致模型表现不佳。此外，尽管 XGBoost 的强大性能在大多数情况下表现出色，但它的解释性较差，不如简单模型容易解读。
	对于某些问题，XGBoost 的复杂性可能带来过拟合风险，尤其是当训练数据的规模和质量不足时。
	总体来说，XGBoost 非常适合高维度数据集和需要高精度的应用场景，但在某些情况下可能需要平衡其复杂性与可解释性。
	Liu等（2018）在其研究中使用了XGBoost算法对中国的土地覆盖进行分类，证明了该方法在复杂地理环境下的高效性\cite{liu2018}。Wang等（2020）则应用XGBoost算法在中国东北地区进行森林火灾监测，在精度上优于传统的回归模型\cite{wang2020Y}。在环境变化监测方面，Zhu等（2019）应用 XGBoost 对全球气候变化对植被覆盖的影响进行了建模研究，能够准确捕捉气候变化对植被分布的影响，尤其是在处理具有高度空间相关性的变量时，XGBoost 展现了较高的预测能力\cite{zhu2019}。
	在城市扩张研究中，Chen等（2021）利用 XGBoost 对城市土地利用变化进行了长时间序列的预测，有效整合多源数据，提升城市扩展预测的精度\cite{chen2021}。
	
	\subsection{LightGBM}
	
	LightGBM（Light Gradient Boosting Machine）是一种高效的梯度提升框架，专为处理大规模数据集和高维特征而设计 \cite{ke2017lightgbm}。
	它由微软的 DMTK（Distributed Machine Learning Toolkit）团队开发，旨在提高模型训练的速度和效率。
	LightGBM采用基于直方图的学习算法，将连续特征分桶为离散的直方图，这样不仅减少了内存使用，还加速了计算过程。
	与传统的梯度提升方法相比，LightGBM具有多个显著优势。首先，它支持按叶子生长的树结构，而非按层生长，这使得模型能更好地捕捉数据的复杂性，并提高预测的准确性。
	其次，LightGBM在处理大数据时表现出色，能够利用分布式训练和并行计算来加速训练过程。它还具有较低的内存消耗和高效的训练速度，尤其适合需要快速响应的场景。
	此外，LightGBM具有多种参数设置，可以有效控制模型的复杂度，减少过拟合的风险。它广泛应用于机器学习竞赛和实际应用中，尤其是在金融、广告、推荐系统和图像识别等领域。
	由于其高效性和灵活性，LightGBM已经成为数据科学家和机器学习工程师的热门选择，是现代机器学习工具箱中不可或缺的一部分。
	在城市土地利用研究中，Wu等（2020）应用LightGBM模型对中国上海市的城市扩展进行了研究，较好地处理空间分布不均的数据，
	准确预测了上海市在未来几十年的城市扩张情况，且在模型训练和预测过程中，相较于传统算法，具有更快的训练速度和更低的内存占用。\cite{wu2020}。
	在环境监测领域，Liang 等（2018）利用LightGBM进行了气候变化对植被生长影响的研究，有效整合多源数据，准确捕捉气候变化对植被生长的影响\cite{liang2018}。
	在生态灾害监测中，Zhang 等（2019）应用LightGBM对森林火灾发生的风险进行了预测,结果显示LightGBM在处理火灾风险评估中的表现优于传统模型，特别是在高维度特征和数据稀疏的情况下，其预测精度和计算效率得到了显著提高。\cite{zhang2019}。
	
	\subsection{分位数随机森林}
	
	分位数回归（Quantile Regression）是一种用于估计不确定性的传统方法 \cite{koenker2005quantile}，其输出能够反映未观测数据点的不确定性范围（上界和下界）。
	尽管传统的分位数回归主要基于线性模型，但近年来，该方法已被扩展至随机森林，形成了分位数随机森林（Quantile Random Forest, QRF） \cite{meinshausen2006quantile}。
	与传统随机森林仅估计目标变量 \( y \) 在给定输入特征 \( x \) 时的条件均值 \( E(y|x) \) 不同，分位数随机森林能够估计整个条件概率分布 \( p(y|x) \)。
	该概率密度的估计依赖于从训练好的随机森林模型中提取的数值权重 \( \omega_i (x) \)，这些权重用于衡量每个训练样本点对新数据点的贡献。  
	数学上，条件分布的累积分布函数（CDF） \( F(y|x) \) 可表示为指示函数 \( I\{Y \leq y\} \) 的期望值：
	
	\begin{equation}
		F(y|X = x) = E (I\{Y \leq y\} |X = x)
	\end{equation}
	
	在实际计算中，模型的估计值 \( \hat{F}(y|X = x) \) 可表示为所有训练样本上的加权均值：
	
	\begin{equation}
		\hat{F}(y|X = x) = \sum_{i=1}^{n} \omega_i (x) I\{Y_i \leq y\}
	\end{equation}
	
	其中，权重 \( \omega_i (x) \) 由随机森林的树结构决定，每个训练样本点根据其所在的叶节点区域对新样本进行贡献。  
	
	基于条件分布函数 \( F(y|x) \)，分位数 \( Q_{\alpha}(x) \) 定义如下：
	
	\begin{equation}
		Q_{\alpha} (x) = \inf \{y : F(y|X = x) \geq \alpha \}
	\end{equation}
	
	其中，\( \alpha \) 是介于 0 和 1 之间的分位数值，例如 \( \alpha = 0.05 \) 对应 5\% 分位数（下界），\( \alpha = 0.95 \) 对应 95\% 分位数（上界）。通过估计这些分位数，QRF 能够提供比传统均值回归更丰富的不确定性信息，在气候预测、金融风险管理等领域具有广泛应用。
	
	\subsection{SHAP图}
	
	SHAP（SHapley Additive exPlanations）图是一种基于 Shapley 值的解释工具，用于揭示机器学习模型中的特征贡献。
	Shapley 值最早来自合作博弈论，用于衡量每个参与者对总体收益的贡献；在模型解释中，每个特征的贡献被视为参与者。
	SHAP 图利用了 Shapley 值的加性特性，将各个特征的贡献加和成模型的预测值，以可视化模型输出对输入特征的敏感性和依赖性 \cite{lundberg2017unified}。	在计算单个特征的 SHAP 值时，所有可能的特征组合都被考虑，并通过求取平均边际贡献来表示该特征的贡献大小。
	
	给定一个机器学习模型 \( f \) 和输入特征集合 \( \mathbf{x} \)，某一特征 \( x_i \) 的 Shapley 值 \( \phi_i \) 定义如下：
	
	\[
	\phi_i(f) = \sum_{S \subseteq N \setminus \{i\}} \frac{|S|! (|N| - |S| - 1)!}{|N|!} \left( f(S \cup \{i\}) - f(S) \right)
	\]
	
	其中，\( S \subseteq N \setminus \{i\} \) 表示特征集合 \( S \) 是除了 \( x_i \) 外的所有特征子集，\( f(S \cup \{i\}) \) 表示模型在特征 \( x_i \) 和 \( S \) 的联合特征集上的预测值，而 \( f(S) \) 表示没有特征 \( x_i \) 时的预测值。公式中的系数 \( \frac{|S|! (|N| - |S| - 1)!}{|N|!} \) 是用于权衡所有特征组合的权重。SHAP 图将特征的 Shapley 值绘制为不同颜色的条形或散点图，其中每个点代表一个样本实例，每个特征的贡献大小和方向可视化地表达为模型预测的加性影响。
	
	\section{深度学习模型}
	
	\subsection{TensorFlow}
	
	TensorFlow 是一个广泛使用的开源深度学习框架，由Google Brain团队于2015年发布，具有高度的灵活性和可扩展性，
	适合开发各种规模和复杂度的机器学习模型 \cite{tensorflow2015-whitepaper}。
	TensorFlow的设计是高度模块化的，提供了多个层次的抽象，使得开发者可以根据需求选择合适的操作层级。从底层的低级API（如TensorFlow Core）到更高级的API（如Keras），都可以轻松使用。Keras 是 TensorFlow 官方推荐的高级 API \cite{keras}，它简化了深度学习模型的构建、训练和评估过程，使得即使是新手也能轻松上手。
	TensorFlow不仅适用于研究和开发人员，还广泛应用于生产环境，支持模型的部署和推理。TensorFlow Serving是一个专门为生产环境优化的模型服务框架，它能够高效地部署和管理机器学习模型。TensorFlow Lite则专注于移动设备和嵌入式系统上的推理任务 \cite{tensorflowlite}，TensorFlow.js 使得模型可以直接在浏览器中运行，适合开发 Web 应用 \cite{tensorflowjs}。
	
	然而，TensorFlow 也有一些劣势。首先，它相较于某些框架（如 PyTorch）来说，学习曲线较陡，特别是对于新手而言，编写和调试代码可能较为复杂。
	虽然 TensorFlow 2.x 改进了许多 API 的易用性，但其底层机制仍然偏底层，初学者可能会感到难以驾驭。
	其次，尽管 TensorFlow 在性能上表现强劲，但由于其高度复杂性和庞大结构，部署和调优模型可能需要更多时间和计算资源。
	另外，TensorFlow 的灵活性有时反而会带来问题，当不需要大规模并行计算时，其复杂性和资源占用可能显得过度。
	在遥感影像分析方面，Li 等（2019）使用 TensorFlow 进行了土地覆盖变化检测研究\cite{li2019}。
	在气候变化研究中，Wang 等（2020）利用 TensorFlow构建循环神经网络（RNN）模型，对不同区域的植被变化进行时序预测，使得模型能够准确捕捉到气候变化对植被的长期影响。\cite{wang2020H}。
	在城市土地利用变化研究中，Zhao 等（2021）使用 TensorFlow 构建了一个深度生成对抗网络（GAN）模型，建立了一个多层次、多尺度的模型，成功预测了未来几十年内的城市扩展情况。\cite{zhao2021}。
	在生态监测领域，Chen 等（2018）使用 TensorFlow 构建了一个深度学习模型来识别和监测森林火灾的风险\cite{chen2018}。
	在海洋环境监测和物种识别方面，Zhang 等（2020）通过 TensorFlow 利用深度卷积神经网络对海洋生态环境中的物种进行自动识别\cite{zhang2020}。
	总的来说，TensorFlow是一个功能强大且适用于各种机器学习任务的框架，特别适合大规模分布式训练和深度学习模型的开发，但在易用性和调试方面需要较高的技术门槛。

	\subsection{PyTorch}
	
	PyTorch 是一个开源的深度学习框架，最初由 Facebook AI Research（FAIR）团队开发 \cite{paszke2019pytorch}。

	PyTorch 是用 Python 实现的，并且由于与 Python 科学计算库（如 NumPy 和 SciPy）的良好兼容性，PyTorch 成为了许多机器学习从业者的首选框架。
	PyTorch 的一个关键特点是它的动态计算图，也被称为“define-by-run”机制。与 TensorFlow 最初采用的静态计算图（define-and-run）不同，PyTorch 的动态计算图允许在模型开发过程中更加灵活。这使得在模型构建和调试时，开发者能够更加容易地修改和优化模型，因为图是在执行过程中动态生成的，而不是事先定义好的。这个特点使得 PyTorch 在科研领域特别受欢迎，因为在研究中，模型架构往往会频繁发生变化。
	除了对深度学习的广泛支持外，PyTorch 还在部署能力上不断改进。通过引入 TorchScript \cite{torchscript} 使 PyTorch 模型可以序列化并在生产环境中部署。利用 TorchServe \cite{torchserve}，PyTorch 模型可以高效地进行大规模部署，为生产环境中的模型服务提供了便捷的解决方案。
	这使得 PyTorch 不仅是一个研究工具，而且在工业应用中也展现出了巨大的潜力。
	PyTorch 持续通过社区贡献和合作进行发展。其活跃的开源社区确保了新特性的引入、优化以及 bug 修复，且 PyTorch 在云计算平台（如 AWS、Azure 和 Google Cloud）上的集成支持也促进了分布式训练和扩展，用户可以在大规模数据集上训练模型，甚至跨多台机器进行训练。
	总的来说，PyTorch 已经成为学术界和工业界最流行和广泛使用的深度学习框架之一。
	它的易用性、动态计算图、丰富的预构建功能以及强大的社区支持促成了它的快速普及。
	随着持续的发展和改进，PyTorch 很可能在未来几年继续在机器学习研究和应用中占据重要地位。
	




	\chapter{结果}
	
	\section{贝叶斯回归模型}
	通过加载必要的库 \texttt{bayesplot} \cite{bayesplot2018}、\texttt{rstanarm} \cite{rstanarm2018} 和 \texttt{ggplot2} \cite{ggplot2}，我们设置工作目录并读取数据文件。

	接着，我们对数据中的自变量进行了标准化，保持因变量 \texttt{RATIO} 不变。然后，使用标准化后的数据进行拟合，得到一个贝叶斯回归模型，并提取其参数。
	为了展示回归系数的后验分布，我们排除了某些不需要展示的参数，并绘制了一个包含80\%置信区间的 MCMC 后验分布图。
	接着，我们计算了每个回归系数的点估计（中位数）以及其95\%的置信区间。
	计算完成后，整理并格式化了一个包含这些结果的数据框，最后使用 \texttt{xtable} 包将该数据框转化为 LaTeX 格式的表格，并打印出相应的 LaTeX 代码。
	贝叶斯回归分析结果显示了17个气候、地理与土壤变量对响应变量（植物病害）的影响。
	自变量中，“土壤砂含量”（S SAND）的回归系数为2.82，95\%可信区间为0.45至5.16，表明其对植物病害有显著的正向影响。
	相比之下，“经度”（LON）和“海拔”（ELEV）的回归系数分别为-0.90和-1.22，95\%可信区间分别为-2.36至0.66和-3.23至0.89，表明它们对植物病害的影响为负。
	其他变量，如“太阳辐射”（SRAD）、“风速”（WIND）和“气压”（VAPR）对植物病害的影响较小，且可信区间较宽，反映出它们的影响较为不确定。
	此外，“表层土壤砂含量”（T SAND）和“表层土壤砾石含量”（T GRAVEL）也呈负相关，但后者的可信区间包含零，意味着其可能没有显著影响。
	总体来说，这些结果表明，不同的气候、地理和土壤变量对植物病害有不同程度的影响，其中部分变量呈显著的正向或负向关联，而其他变量则影响较小或较为不确定。
	
	
	\begin{table}[H]
		\centering
		\caption{17个气候、地理与土壤变量的与响应变量之间的贝叶斯回归分析结果。自变量包括经度 (Longitude)、纬度 (Latitude)、海拔 (Elevation)、太阳辐射 (SolarRadiation)、土壤砂含量 (SoilSand)、气压 (VaporPressure)、风速 (WindSpeed)、最大温度 (MaximumTemperature)、平均温度 (AverageTemperature)、最小温度 (MinimumTemperature)、年均降水量 (MeanAnnualPrecipitation)、表层土壤砂含量 (TopsoilSand)、土壤参考容重 (SoilReferenceBulkDensity)、表层土壤参考容重 (TopsoilReferenceBulkDensity)、土壤黏土含量 (SoilClay)、表层土壤砾石含量 (TopsoilGravel)。}
		\caption*{Bayesian regression analysis results for 17 climate, geographic, and soil variables with respect to the response variable. The independent variables include Longitude, Latitude, Elevation, Solar Radiation, Soil Sand Content, Vapor Pressure, Wind Speed, Maximum Temperature, Average Temperature, Minimum Temperature, Mean Annual Precipitation, Topsoil Sand Content, Soil Reference Bulk Density, Topsoil Reference Bulk Density, Soil Clay Content, and Topsoil Gravel Content.}
		\begin{tabular}{ccccc}
			\hline
			Response & Predictor & Estimate & Est.error & 95\% CI \par (Credible intervals) ) \\ 
			\hline
			Plant Disease & SRAD & -0.97 & 0.86 & -1.83--0.11 \\ 
			Plant Disease & S SAND & -0.19 & 1.56 & -1.75-1.3 \\ 
			Plant Disease & LON & -0.67 & 1.63 & -2.3-0.92 \\ 
			Plant Disease & PSEA & -0.17 & 0.94 & -1.11-0.76 \\ 
			Plant Disease & WIND & 0.09 & 0.97 & -0.88-1.07 \\ 
			Plant Disease & VAPR & -1.53 & 2.96 & -4.49-1.41 \\ 
			Plant Disease & ELEV & -1.62 & 2.97 & -4.59-1.24 \\ 
			Plant Disease & TSEA & 0.14 & 3.95 & -3.81-4.07 \\ 
			Plant Disease & MAP & -0.59 & 1.46 & -2.05-0.91 \\ 
			Plant Disease & T SAND & 1.63 & 2.17 & -0.54-3.98 \\ 
			Plant Disease & T BULK DEN & 0.21 & 0.57 & -0.36-0.74 \\ 
			Plant Disease & T REF BULK & -2.38 & 2.55 & -4.93-0.12 \\ 
			Plant Disease & S CLAY & -0.53 & 1.46 & -1.99-0.86 \\ 
			\hline
		\end{tabular}
		
	\end{table}
	
	
	
%	\begin{figure}[H]  % 创建浮动体（figure）
%		\centering  % 图片居中
%		\caption{包括中位数和80\%的区间回归系数的后验分布}
%		\caption*{Posterior Distributions of Regression Coefficients with Medians and 80\% Intervals}
%		
%		\includegraphics[width=0.8\textwidth]{pic/Rplot.png}  
%		
%		\label{fig:example}  % 设置标签，可以用于交叉引用
%	\end{figure}

	\section{结构方程模型}

	在这段代码中，我们首先加载了必要的 R 包 `seminr` 和 `dplyr`，并设置了工作目录。接着，通过 `read.csv` 函数读取了名为 `selection.csv` 的数据文件，并将其中的列 `RATIO` 重命名为 `Pathogen Load`，以便后续分析中使用。

	我们定义了几个测量项，包括气候变量（如 SRAD、PSEA、WIND 等）、土壤变量（如 S\_SAND、S\_CLAY、T\_SAND 等）和地理变量（如 LAT、LON、ELEV）。随后，通过 `constructs` 函数构建了反射性构念和复合构念模型，包含了 `Climate`、`Soil`、`Geo` 和 `Pathogen Load` 四个构念，其中 `Pathogen Load` 被定义为单一测量项。

	在结构关系部分，我们定义了不同构念之间的路径关系，具体为气候和地理因素对土壤的影响，以及气候、地理和土壤对病原负荷（`Pathogen Load`）的共同影响。然后，我们检查了数据框的结构，确保数据类型正确，必要时将某些列转换为数值型，以便进行后续分析。

	接着，我们使用 `estimate\_pls` 函数估计了部分最小二乘法（PLS）模型，通过 `plot` 函数绘制了 PLS 模型，并使用 `ggsave` 函数将绘制的图像保存为高分辨率的 PNG 图像。
	通过这个过程，我们建立了一个能够分析气候、土壤和地理因素如何共同影响病原负荷（Pathogen Load）的结构方程模型。
		
	
	
	\section{集成学习模型}
	
	\subsection{展示变量的重要性}
	

	
	我们在特征选择完成后，我们使用随机森林回归模型重新训练了一个模型，获取了各个特征的重要性。我们将特征的重要性值与对应的特征名存储在一个 DataFrame 中，并根据特征的重要性进行排序。
	为了使特征名更加清晰易懂，我们用 apply() 方法替换了特征名中的下划线为空格。
	随机森林变量重要性结果显示了17个气候、地理与土壤变量对响应变量（植物病害）的贡献。
	在这些变量中，气候因素“太阳辐射”（SRAD）对植物病害的影响最为显著，其重要性值为0.16。
	地理因素“经度”（LON）和“纬度”（LAT）以及土壤因素“土壤砂含量”（S SAND）对植物病害的贡献次之，重要性值均为0.08。
	气候因素“气压”（VAPR）和“风速”（WIND）以及地理因素“海拔”（ELEV）的重要性值分别为0.08和0.07，表明它们对植物病害也具有一定的影响。
	其他气候因素，如“最大温度”（MAX MAT）、“年均降水量”（MAP）、“平均温度”（AVG MAT）和“最小温度”（MIN MAT），对植物病害的影响较小，重要性值均低于0.06。
	土壤因素如“土壤黏土含量”（S CLAY）、“表层土壤砂含量”（T SAND）、“土壤参考容重”（T REF BULK）以及“表层土壤参考容重”（S REF BULK）等的贡献更为有限，重要性值均低于0.03。
	总体而言，气候因素在解释植物病害时占主导地位，而土壤和地理因素的贡献较小。
	
	
	\begin{table}[H]
		\caption{17个气候、地理与土壤变量的与响应变量之间的随机森林变量重要性结果。自变量包括经度 (Longitude)、纬度 (Latitude)、海拔 (Elevation)、太阳辐射 (SolarRadiation)、土壤砂含量 (SoilSand)、气压 (VaporPressure)、风速 (WindSpeed)、最大温度 (MaximumTemperature)、平均温度 (AverageTemperature)、最小温度 (MinimumTemperature)、年均降水量 (MeanAnnualPrecipitation)、表层土壤砂含量 (TopsoilSand)、土壤参考容重 (SoilReferenceBulkDensity)、表层土壤参考容重 (TopsoilReferenceBulkDensity)、土壤黏土含量 (SoilClay)、表层土壤砾石含量 (TopsoilGravel)。}
		\caption*{The random forest variable importance results for 17 climate, geographic, and soil variables with respect to the response variable. These factors include Longitude, Latitude, Elevation, Solar Radiation, Soil Sand Content, Vapor Pressure, Wind Speed, Maximum Temperature, Average Temperature, Minimum Temperature, Mean Annual Precipitation, Topsoil Sand Content, Soil Reference Bulk Density, Topsoil Reference Bulk Density, Soil Clay Content, and Topsoil Gravel Content.}
		\label{tab:feature_importance}
		\begin{tabular}{cccc}
			\toprule
			Response & Feature & Category & Importance \\
			\midrule
			Plant Disease & SRAD & Climate & 0.15 \\
			Plant Disease & S SAND & Soil & 0.08 \\
			Plant Disease & TSEA & Climate & 0.08 \\
			Plant Disease & LON & Geography & 0.07 \\
			Plant Disease & VAPR & Climate & 0.07 \\
			Plant Disease & MAX MAT & Climate & 0.07 \\
			Plant Disease & WIND & Climate & 0.06 \\
			Plant Disease & PSEA & Climate & 0.06 \\
			Plant Disease & LAT & Geography & 0.05 \\
			Plant Disease & ELEV & Geography & 0.05 \\
			Plant Disease & MAP & Climate & 0.05 \\
			Plant Disease & AVG MAT & Climate & 0.04 \\
			Plant Disease & MIN MAT & Climate & 0.04 \\
			Plant Disease & S CLAY & Soil & 0.03 \\
			Plant Disease & T SAND & Soil & 0.03 \\
			Plant Disease & T REF BULK & Soil & 0.02 \\
			Plant Disease & T BULK DEN & Soil & 0.02 \\
			\bottomrule
		\end{tabular}
	\end{table}
	

	在完成特征选择后，我们基于排序靠前的 17 个特征训练了 XGBoost 回归模型，并将数据集划分为训练集和测试集，模型在测试集上的均方误差（MSE）以及 R 方 分数表明其性能良好。
	模型训练完成后，我们使用 \texttt{joblib} \cite{joblib} 将训练好的模型保存到指定目录中，以便后续使用。
	为了进一步解释模型，我们利用 SHAP 值（Shapley Additive Explanations）评估了每个特征对模型预测的影响，并生成了 SHAP 值的可视化图表。
	通过计算每个特征的平均绝对 SHAP 值以及置信区间，我们总结出了对模型影响最大的特征，并绘制了 SHAP 总结图以展示各特征的重要性和方向性变化。
	
	
%	\begin{figure}[H]  % 创建浮动体（figure）
%		\centering  % 图片居中
%		\includegraphics[width=0.8\textwidth]{pic/shap_summary_plot.png}  
%		\caption{中国地区植物病害xgboost模型的shap图}
%		\caption*{SHAP Plot of the XGBoost Model for Plant Diseases in China}
%		
%		\label{fig:example}  % 设置标签，可以用于交叉引用
%	\end{figure}
	
	\subsection{模型的优化与选择}
	
	我们加载了几个常用的 R 包，包括 caret\cite{caret}、ggplot2\cite{ggplot2}、dplyr\cite{dplyr}、tidyr\cite{tidyr} 和 ggthemes\cite{ggthemes}，分别用于机器学习、绘图、数据处理和整理。
	我们设定了随机种子，确保实验结果的可复现性。
	然后，我们通过读取存储在指定路径下的 CSV 文件，导入了数据集。接着，我们定义了一个 10 折重复交叉验证的控制方法，并选择了一个响应变量 RATIO 进行建模。
	在模型训练部分，我们设定了一个包含多种模型的列表，包括 cubist, rf, xgbLinear 等，并通过循环检查每个模型文件是否已经存在。如果模型已经训练过，则直接加载模型；如果没有，则使用 train 函数进行训练，并将训练好的模型保存到文件中。
	训练完成后，我们将所有模型的结果进行汇总，提取了每个模型的 R² 和 RMSE 值。为了便于后续分析，我们对这些结果进行了数据处理，转换成长格式并重新排序，以便后续绘图时根据模型的均值排序。接下来，我们使用 ggplot2 绘制了一个包含多个模型和评估指标（如 R² 和 RMSE）的可视化图表，并调整了图表的主题和样式，确保图表简洁、美观。


	% \begin{figure}[H]  % 创建浮动体（figure）
	% 	\centering  % 图片居中
	% 	\caption{不同模型下的10 折重复交叉验证图}
	% 	\caption*{Ten-fold repeated cross-validation plot of different models}		
	% 	\includegraphics[width=1\textwidth]{pic/cv_comp_plot.png}  
		
	% 	\label{fig:example}  % 设置标签，可以用于交叉引用
	% \end{figure}


	我们使用了 \texttt{LazyRegressor} \cite{lazyregressor} 工具对数据集进行了回归模型的比较分析。，以便快速评估不同模型的性能。目标变量是 植物病害，而特征由其余变量组成。数据集被划分为训练集和测试集，采用 8:2 的比例。LazyRegressor 自动训练了多种回归模型，并对它们在测试集上的性能进行了评估，主要通过调整后的 R 方（Adjusted R-Squared）、R 方（R-Squared）、均方根误差（RMSE）以及模型运行时间（Time Taken）这几个指标来比较。
	
	结果表明，\texttt{GradientBoostingRegressor} \cite{gradientboosting} 在所有模型中表现最佳，其 Adjusted R-Squared 和 R-Squared 值分别为 0.22 和 0.31，同时 RMSE 为 4.99。这表明它在预测目标变量方面有较高的拟合度。\texttt{RandomForestRegressor} \cite{randomforest} 和 \texttt{HistGradientBoostingRegressor} \cite{histgradientboosting} 分别排名第二和第三，它们的 R-Squared 值分别为 0.29 和 0.27，表现仅次于 \texttt{GradientBoostingRegressor}。值得注意的是，虽然某些模型的计算时间较长，例如 RandomForestRegressor（0.43 秒），但性能提升可能值得权衡。

	\begin{table}[H]
		\centering
		\caption{基于17个气候、地理与土壤变量的LazyRegressor前8个模型的性能，包括$R^2$评分和训练时间。}
		\caption*{Performance comparison of the top 8 models from LazyRegressor based on 17 climate, geographic, and soil variables, including $R^2$ scores and training time.}
		
		\begin{tabular}{lrrrr}
			\toprule
			& Adjusted R-Squared & R-Squared & RMSE & Time Taken \\
			Model &  &  &  &  \\
			\midrule
			GradientBoostingRegressor & 0.22 & 0.31 & 4.99 & 0.18 \\
			RandomForestRegressor & 0.20 & 0.29 & 5.07 & 0.43 \\
			HistGradientBoostingRegressor & 0.18 & 0.27 & 5.11 & 0.19 \\
			LGBMRegressor & 0.18 & 0.27 & 5.13 & 0.06 \\
			ExtraTreeRegressor & 0.17 & 0.26 & 5.14 & 0.01 \\
			ExtraTreesRegressor & 0.17 & 0.26 & 5.15 & 0.19 \\
			BaggingRegressor & 0.17 & 0.26 & 5.15 & 0.06 \\
			DecisionTreeRegressor & 0.17 & 0.26 & 5.15 & 0.01 \\
			\bottomrule
		\end{tabular}
		\label{tab:models_performance}
	\end{table}
	

	调优一个随机森林回归模型，并评估不同\texttt{ntree}和\texttt{mtry}参数配置下的模型表现。我们首先导入所需的库，包括\texttt{numpy}、\texttt{matplotlib}、\texttt{sklearn}和\texttt{pandas}，这些库提供了生成数据、训练模型、计算评估指标和可视化结果的功能。接着，我们设置随机种子（\texttt{random\_state} = 42），以确保实验结果的可重复性。然后，我们从数据集中加载数据，并将数据分为自变量（\texttt{X}）和因变量（\texttt{y}）。自变量包括所有列，除了\texttt{RATIO}，而\texttt{RATIO}列作为目标变量。我们使用\texttt{train\_test\_split}函数将数据集拆分成训练集和测试集，其中训练集占90\%，测试集占10\%。接下来，我们定义了不同的\texttt{ntree}和\texttt{mtry}值范围。\texttt{ntree\_values}从10到200，步长为20，表示我们将尝试不同数量的决策树来训练模型；\texttt{mtry\_values}从3到10，表示我们将尝试不同的特征选择数量，以控制每棵树可以使用的特征数。在接下来的部分，我们初始化了两个字典\texttt{rmse\_dict}和\texttt{r2\_dict}，用于存储每次实验（不同的\texttt{ntree}和\texttt{mtry}值组合）计算的RMSE和$R^2$值。通过嵌套循环，我们对每一种\texttt{mtry}和\texttt{ntree}组合训练一个随机森林回归模型。每次模型训练后，我们用测试集进行预测，并计算RMSE和$R^2$。实现了对随机森林回归模型的调参过程，比较了不同的\texttt{ntree}和\texttt{mtry}参数配置对模型性能的影响。我们利用绘制了网格搜索过程中各个配置的均方误差（MSE）变化曲线，并标出了最佳配置的 MSE 值。图中展示了所有配置的 MSE 值，并突出了具有最低 MSE 的超参数组合。
	
%		
%	\begin{figure}[H]  % 创建浮动体（figure）
%		\centering  % 图片居中
%		\includegraphics[width=0.8\textwidth]{pic/ntreemtry.png}  
%	\caption{基于17个气候、地理与土壤变量的随机森林模型使用不同mtry,ntree的训练结果。}
%	\caption*{Training results of the random forest model based on 17 climate, geographic, and soil variables using different mtry and ntree values.}
%		
%		\label{fig:example}  % 设置标签，可以用于交叉引用
%	\end{figure}
%	
	

	我们对每个模型进行了两种不同的训练方式：一种是直接训练模型，另一种是通过网格搜索（GridSearchCV）\cite{scikit-learn} 来优化超参数。首先，我们读取了气候和土壤数据集，并进行了数据预处理。预处理步骤包括列名清理、特征工程（如计算平均气温、风速、降水量等），并删除了一些不相关的特征。在数据处理后，我们将数据分为训练集和测试集，并使用上述回归模型进行训练。对于使用网格搜索的模型，我们定义了超参数网格并进行了交叉验证，以优化模型性能。随后，我们在测试集上进行了预测，并计算了每个模型的均方误差（MSE）和决定系数（R2）以评估其性能。为了进一步比较不同模型的表现，我们将结果按 R2 值排序。
	

	
	\begin{table}[H]
		\centering
		\caption{基于17个气候、地理与土壤变量的模型的网格搜索模型的表现比较，包括$R^2$评分。}
		\caption*{Comparison of model performance with grid search based on 17 climate, geographical, and soil variables, including the $R^2$ score.}
		\centering
		\begin{tabular}{lrr}
			\toprule
			Model & MSE & R2 \\
			\midrule
			QuantileRandomForest (With GridSearch) & 24.86 & 0.31 \\
			GradientBoosting (No GridSearch) & 25.24 & 0.30 \\
			GradientBoosting (With GridSearch) & 25.65 & 0.29 \\
			RandomForest (No GridSearch) & 25.71 & 0.28 \\
			RandomForest (With GridSearch) & 25.75 & 0.28 \\
			QuantileRandomForest (No GridSearch) & 27.07 & 0.25 \\
			\bottomrule
		\end{tabular}
	\end{table}
	
	\subsection{绘制预测图}
	\par
	在本研究中，我们结合气候数据和土壤数据，采用随机森林算法对目标变量进行了预测。
	首先，我们从多个 \texttt{.tif} 文件中读取了空间栅格数据，并提取了经纬度信息作为特征。
	随后，我们通过特定规则对数据的列名进行了标准化处理，例如去除无关后缀以及重复部分。
	通过筛选和处理，我们生成了新的气候变量，包括年降水总量（MAP）、平均风速（WIND）、最高温度均值（TMAX）、最低温度均值（TMIN）、平均温度（TAVG）、太阳辐射（SRAD）和水汽压（VAPR），并删除了与上述变量相关的原始列。误差（MSE）和决定系数（$R^2$）评估模型的性能。模型在测试集上表现良好，具备较高的预测能力。接下来，我们对多个栅格文件的像素数据进行了预测。为此，我们读取了包含不同空间特征的栅格文件，将其数据堆叠为多维数组，同时保留经纬度信息。基于预训练的随机森林模型，我们对这些数据进行了预测，并将预测结果重新转换为二维栅格格式。
	我们首先使用 Albers 等面积投影坐标系（\texttt{AlbersEqualArea}）进行地图投影设置，并加载了包含中华人民共和国边界的 GeoJSON 数据。通过 \texttt{geopandas} 库，我们将 GeoJSON 数据的坐标系转换为与目标地图一致的自定义投影坐标系。如果数据的坐标系与目标不一致，则进行了转换。接着，我们定义了一些 TIFF 格式的栅格数据文件，这些数据分别表示不同的时间点或区域。
	
	在绘制图形时，我们使用了\texttt{matplotlib}创建了一个 2x2 的子图布局，
	每个子图显示一个 TIFF 文件。对于每个 TIFF 文件，首先提取其文件名并作为标题，
	在每个子图上绘制了之前加载的 GeoJSON 数据边界。同时，使用 \texttt{rasterio} \cite{rasterio} 读取 TIFF 数据，
	并处理无效值（\texttt{no\_data\_value}），将其替换为 NaN。
	栅格数据被映射到颜色映射上，并使用一个从蓝色到绿色再到红色的自定义颜色映射进行可视化。
	
	
	
	
	
	
%	\begin{figure}[H]  % 创建浮动体（figure）
%		\centering  % 图片居中
%		\caption{中国地区的随机森林预测得到的植物病害严重程度结果}
%		\caption*{Predicted severity of plant diseases in China using the Random Forest model}
%		
%		\includegraphics[width=0.8\textwidth]{pic/cropped_predicted_rf.png}  
%		
%		\label{fig:example}  % 设置标签，可以用于交叉引用
%	\end{figure}
	
	
%	\begin{figure}[H]  % 创建浮动体（figure）
%		\centering  % 图片居中
%		\caption{a：2040年ssp1.26方案植物病害预测严重程度结果,b：2040年ssp2.45方案植物病害预测严重程度结果,
%			c：2040年ssp3.70方案植物病害预测严重程度结果,d：2040年ssp5.85方案植物病害预测严重程度结果}
%		\caption*{a: Predicted plant disease severity in 2040 under the SSP1-2.6 scenario,
%			b: Predicted plant disease severity in 2040 under the SSP2-4.5 scenario,
%			c: Predicted plant disease severity in 2040 under the SSP3-7.0 scenario,
%			d: Predicted plant disease severity in 2040 under the SSP5-8.5 scenario}
%		\includegraphics[width=0.8\textwidth]{pic/all_scenarios_rf.png}  
%		
%		\label{fig:example}  % 设置标签，可以用于交叉引用
%	\end{figure}	
	
%	\begin{figure}[H]  % 创建浮动体（figure）
%		\centering  % 图片居中
%		\caption{a：当前与2040年ssp1.26方案植物病害严重程度结果的变化,b：当前与2040年ssp2.45方案植物病害严重程度结果的变化,
%			c：当前与2040年ssp3.70方案植物病害严重程度结果的变化,d：当前与2040年ssp5.85方案植物病害严重程度结果的变化}
%		\caption*n{a: Changes in plant disease severity between the current period and 2040 under the SSP1-2.6 scenario,
%			b: Changes in plant disease severity between the current period and 2040 under the SSP2-4.5 scenario,
%			c: Changes in plant disease severity between the current period and 2040 under the SSP3-7.0 scenario,
%			d: Changes in plant disease severity between the current period and 2040 under the SSP5-8.5 scenario}
%		
%		\includegraphics[width=0.8\textwidth]{pic/all_sub_rf.png}  
%		
%		\label{fig:example}  % 设置标签，可以用于交叉引用
%	\end{figure}	
	
	\section{深度学习模型}
	
	我们分别使用 PyTorch 和 TensorFlow 构建并训练了神经网络模型。对于 PyTorch，我们定义了一个包含三层全连接层的神经网络，使用 LeakyReLU 激活函数和 Dropout 层，并通过 Adam 优化器和均方误差损失函数进行训练。为了避免过拟合，我们还使用了早停（early stopping）机制，当验证损失连续若干个 epoch 没有改善时停止训练。对于 TensorFlow，我们采用了类似的神经网络结构，使用 Keras 提供的 Sequential API 构建模型，优化器为 Adam，损失函数为均方误差，并使用了学习率衰减和早停回调。我们训练了两个模型并记录了训练和验证损失，计算了每个模型在测试集上的预测性能，通过均方误差（MSE）和决定系数（R方）来评估模型的准确性。
	
	\begin{table}[H]
		\centering
		\caption{神经网络回归模型的训练与验证损失曲线MSE和R方}
		\caption*{Training and Validation Loss Curves of Neural Network Regression Model: MSE and R²}
		
		\begin{tabular}{lrr}
			\toprule
			Model & MSE & R方 \\ 
			\midrule
			PyTorch & 24.8267 & 0.3091 \\
			TensorFlow & 24.8613 & 0.3081 \\
			\bottomrule
		\end{tabular}
		
		\label{tab:model_comparison}
	\end{table}
	
%	\begin{figure}[H]  % 创建浮动体（figure）
%		\centering  % 图片居中
%		\caption{神经网络回归模型的训练与验证损失曲线}
%		\caption*{The training and validation loss curve of the neural network regression model.}
%		
%		\includegraphics[width=0.8\textwidth]{pic/loss_comparison.png}  
%		
%		\label{fig:example}  % 设置标签，可以用于交叉引用
%	\end{figure}
	
	为了优化模型，我们构建了一个卷积神经网络模型（CNN），用于预测目标变量 "Pathogen Load"（植物病原负荷）。我们通过设置一个最小和最大 epoch 数量，并在每次训练后使用早期停止（EarlyStopping）回调来监控验证集上的损失。如果训练在设置的最小 epoch 数之前提前停止，我们会重新训练模型直到达到所需的 epoch 数量。接下来，我们使用训练好的模型进行预测，并通过 evaluate\_model 和 evaluate函数评估模型性能，计算并输出均方误差（MSE）、R²值和相对百分比误差（RPD）。最后，评估结果以图表的形式展示，左侧图展示了实际值与预测值的散点图以及回归线，右侧图展示了训练过程中验证集与训练集的损失变化曲线。所有的评估图表都被保存为 PNG 文件，并且结果通过打印输出。最终，我们得到了训练过程中表现的相关评估指标，模型在900个 epoch 后达到了早期停止条件。
%		\begin{figure}[H]  % 创建浮动体（figure）
%		\centering  % 图片居中
%		\caption{全连接神经网络模型的回归图和误差直方图}
%		\caption*{Regression Plot and Error Histogram of the Fully Connected Neural Network Model}		
%		\includegraphics[width=0.8\textwidth]{pic/combined_regression_and_error_plot.png}  
%		
%		% 设置标签，可以用于交叉引用
%	\end{figure}
	
	为了提高神经网络的准确性，我们参考了文献中的方法 \cite{goodfellow2016deep, glorot2011deep, kingma2015adam, james2013introduction, chollet2018deep}，构建并训练了一个多个全连接层（Dense Layer）组成，每一层都采用ReLU激活函数的神经网络模型，通常被称为全连接神经网络（Fully Connected Neural Network,FCNN），用于预测目标变量。首先，我们为每个输入创建了独立的全连接层（NN1\_Dense 到 NN6\_Dense），然后将这些层按两两组合进行拼接（merge1、merge2、merge3），以形成输入的综合表示。随后，这些合并后的表示通过进一步的全连接层（NN\_merge1、NN\_merge2、NN\_merge3）进行处理，最终得出预测结果。

	模型使用Adam优化器和均方误差（MSE）损失函数进行了编译。训练过程中，我们通过一个回调函数在每个完成的训练周期（epoch）后打印一个点，以便追踪训练进度。模型被训练了1000个周期，验证集比例为20\%。训练完成后，我们绘制了平均绝对误差（MAE）和均方误差（MSE）随训练周期变化的图表，以便观察训练集和验证集的表现。

	在训练完成后，我们使用测试集对模型进行了评估。训练集的R方值为0.599，表明模型在训练数据上有一定的表现，但测试集的R方值较低，仅为0.353，表明模型在新数据上的泛化能力较差。通过对比真实值和预测值，可以看到预测结果与真实值存在一定的偏差，尤其是某些预测值高于或低于实际值。

	最后，我们还分析了预测误差的直方图，展示了预测值与真实值之间差异的分布情况。我们还计算并输出了测试集的均方误差（MSE）、平均绝对误差（MAE）以及训练集和测试集的R方值。

	从整体来看，尽管模型在训练数据上表现较好（R方值约为0.60），但在测试数据上的表现较差（R方值约为0.35），说明模型的泛化能力有待提高。

	% \begin{figure}[H]  % 创建浮动体（figure）
	% 	\centering  % 图片居中
	% 	\caption{多层神经网络回归模型的回归图和误差直方图}
	% 	\caption*{Regression plot and error histogram of the multilayer neural network regression model}		
	% 	\includegraphics[width=0.8\textwidth]{pic/combined_regression_and_error_plot.png}  
		
	% 	\label{fig:example}  % 设置标签，可以用于交叉引用
	% \end{figure}
	DenseNet是一个包含多个密集块（DenseBlock）和过渡层（TransitionLayer）的网络架构。密集块使用了瓶颈层（BottleneckLayer）来提取特征，每个瓶颈层由两个卷积层组成，用以捕捉数据的不同层次信息。过渡层则用于降低特征图的尺寸，同时保持有用的特征信息。每个密集块和过渡层的组合帮助模型在处理数据时逐步提取更高级的特征。
	
	同时我们实现了一个基于WaveNet架构的回归模型，用于预测病原负荷（Pathogen Load）。WaveNet架构，这是一种基于扩张卷积（dilated convolution）的神经网络架构，旨在捕捉时间序列中的长期依赖关系。模型将特征经过多个卷积层后，通过Dropout层来防止过拟合，最终输出一个表示病原负荷的数值。在卷积层的设计中，采用了不同的扩张率来捕获不同尺度的时间特征，从而增强了模型对复杂模式的学习能力。在模型编译和训练过程中，采用了均方误差（MSE）作为损失函数，并使用Adam优化器进行优化。为了避免过拟合，训练过程中使用了早停策略（EarlyStopping），当验证集上的损失不再改善时，提前停止训练。训练过程中，模型的最佳权重会被保存下来。在第一个子图中，我们将各个模型的训练损失曲线绘制出来，横坐标是训练的 epoch 数，纵坐标是损失值；第二个子图绘制了每个模型的验证损失曲线，展示了验证阶段的损失变化。两个子图的 Y 轴范围都设置为 10 到 50，以便于比较不同模型的损失变化趋势，并且为每个曲线添加了图例，方便区分不同模型。接下来，我们使用另外一组文件（包含每个模型的实际值与预测值对比数据）来绘制实际值与预测值之间的关系。。首先，denseNet 在最优训练集和验证集损失上表现较好，最优训练集损失为 41.26，而最优验证集损失则为 35.57，这表明该模型能够较好地拟合数据，并在验证集上保持较低的误差。相比之下，wavenet1 的最优训练集损失为 771.14，验证集损失为 145.74，显示出该模型在训练过程中存在较大波动，未能达到较好的拟合效果。对于 wavenet2，其最优训练集损失为 21.29，最优验证集损失为 21.38，二者接近，且验证集损失为所有模型中最低，表明该模型在训练集和验证集上的表现都较为优秀，可能存在较为平衡的拟合情况。最后，wavenet5 的最优训练集损失为 16.30，最优验证集损失为 22.81，虽然训练集损失较低，但验证集损失相对较高，可能表明该模型在训练集上过拟合，无法很好地推广到验证集。综合来看，wavenet2 在所有模型中表现最佳，其验证集损失最低，而 wavenet1 的表现相对较差。
	
	
\chapter{讨论}
本研究采用多源数据整合和机器学习方法，以量化环境变量对植物病害的影响，并提高病害预测的准确性。首先，我们基于全国范围的实地调查数据，结合全球气候数据库（WorldClim）和土壤数据库（HWSD），确保了环境变量的广度和代表性。这种数据整合方法不仅提高了研究的空间覆盖范围，也使得环境因子的影响能够在更大尺度上得到验证。

其次，在方法论上，我们采用贝叶斯建模分析环境变量与植物病害之间的关系，从统计学角度评估变量的影响方向和不确定性。同时，我们应用多种集成学习模型（如随机森林、梯度提升机等）进行预测，并利用LazyRegressor优化模型选择，最终确定GradientBoostingRegressor（GBR）为最优模型。这种方法的优势在于，贝叶斯建模提供了变量影响的可解释性，而机器学习模型则提升了预测能力，两者结合能够更全面地揭示植物病害的环境驱动机制。

此外，我们还引入深度学习方法（PyTorch和TensorFlow）训练神经网络，以评估其在植物病害预测中的潜力。实验结果表明，深度学习模型的收敛性和泛化能力存在一定局限性，但仍为未来研究提供了探索方向。

本研究的方法体系不仅能够提升植物病害的预测精度，还为理解气候变化背景下病害的时空分布提供了科学依据。这一综合分析框架可推广至其他生态环境研究，进一步推动大尺度环境数据在病害防控中的应用。

\chapter{总结与展望}

本研究通过整合多源大尺度环境数据，并结合贝叶斯建模、机器学习和深度学习方法，系统探讨了植物病害的环境驱动机制。
研究发现，土壤砂含量、太阳辐射、地理因素（经度、纬度）是影响植物病害的重要因素，而气压和风速的影响相对较弱。
通过GradientBoostingRegressor（GBR）建模，我们构建了高精度的病害预测模型，并进一步模拟了气候变化背景下的病害分布情况。

尽管本研究取得了一定的进展，但仍存在一些值得深入探讨的问题。
首先，环境变量的时空动态变化可能对病害发生产生更复杂的影响，未来可以进一步探索时序分析方法，如长短时记忆网络（LSTM），以提高对实时监测环境变化并准确预测病害的能力\cite{Patle2022}。
其次，尽管深度学习方法在本研究中未表现出显著优势，但随着数据量的增加和模型结构的优化，未来有望在植物病害预测中发挥更大的作用。
此外，本研究主要基于大尺度环境数据进行分析，而作物品种、农业管理措施等微尺度因素也可能对病害发生产生重要影响，未来的研究可以尝试结合多尺度数据，以构建更全面的预测框架。

总体而言，本研究不仅深化了对植物病害环境驱动机制的理解，也为基于数据驱动的方法在农业病害防控中的应用提供了重要的实践经验。
未来，随着数据获取能力的提升和分析方法的进步，基于人工智能和大数据的植物病害预测方法将更加精准，为农业可持续发展提供科学支撑。

	
	\blankpage
	
	
	
	
	%论文后部
	\backmatter
	
	
	%=======%
	%引入参考文献文件
	%=======%
	\bibdatabase{bib/database}%bib文件名称 仅修改bib/ 后部分
	\printbib
	% \nocite{*} %显示数据库中有的，但是正文没有引用的文献
	
	
	
	\Achievements
	一、发表论文
	
	
	\blank
	
	二、参与课题
	1.国家自然科学基金 植物群落与真菌病害 项目编号 32422054
	2.甘肃省科技计划项目草地植物种类资源挖掘 品种选育 及退化草地近自然恢复项目编号23ZDNA009
	
	
	\Thanks
	
	感谢刘向老师三年以来的指导和培养，感谢父母在学费，生活费给与的支持，感谢同班同学，师兄师姐的关心与帮助。
	
	
\end{document}